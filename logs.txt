2025-08-02 18:26:30,927 - app.main - ERROR - Error on POST /api/v1/auth/signup: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/clsregistry.py", line 516, in _resolve_name
    rval = d[token]
           ~^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_collections.py", line 345, in __missing__
    self[key] = val = self.creator(key)
                      ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/clsregistry.py", line 484, in _access_cls
    return self.fallback[key]
           ~~~~~~~~~~~~~^^^^^
KeyError: 'FarmShare'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4255, in _do_configure_registries
    mapper._post_configure_properties()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2418, in _post_configure_properties
    prop.init()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/interfaces.py", line 589, in init
    self.do_init()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 1656, in do_init
    self._setup_entity()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 1868, in _setup_entity
    self._clsregistry_resolve_name(argument)(),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/clsregistry.py", line 520, in _resolve_name
    self._raise_for_name(name, err)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/clsregistry.py", line 501, in _raise_for_name
    raise exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:30,936 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/clsregistry.py", line 516, in _resolve_name
    rval = d[token]
           ~^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_collections.py", line 345, in __missing__
    self[key] = val = self.creator(key)
                      ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/clsregistry.py", line 484, in _access_cls
    return self.fallback[key]
           ~~~~~~~~~~~~~^^^^^
KeyError: 'FarmShare'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4255, in _do_configure_registries
    mapper._post_configure_properties()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2418, in _post_configure_properties
    prop.init()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/interfaces.py", line 589, in init
    self.do_init()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 1656, in do_init
    self._setup_entity()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 1868, in _setup_entity
    self._clsregistry_resolve_name(argument)(),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/clsregistry.py", line 520, in _resolve_name
    self._raise_for_name(name, err)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/clsregistry.py", line 501, in _raise_for_name
    raise exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:31,332 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:31,333 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:31,586 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:31,587 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:31,822 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.8ms
2025-08-02 18:26:31,823 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:26:31,875 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-02 18:26:31,875 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:26:31,924 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-02 18:26:31,924 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:26:31,974 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:31,976 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:32,233 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:32,234 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:32,490 - app.main - ERROR - Error on POST /api/v1/auth/login: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 79, in login
    account = await _get_account_by_email(form_data.username, db)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:32,491 - app.main - ERROR - Unhandled exception on /api/v1/auth/login: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 79, in login
    |     account = await _get_account_by_email(form_data.username, db)
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 79, in login
    account = await _get_account_by_email(form_data.username, db)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:32,739 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.3ms
2025-08-02 18:26:32,739 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:26:32,795 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:32,796 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:32:04,763 - app.main - ERROR - Error on POST /api/v1/auth/signup: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2522, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'farm_shares'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4255, in _do_configure_registries
    mapper._post_configure_properties()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2418, in _post_configure_properties
    prop.init()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/interfaces.py", line 589, in init
    self.do_init()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 1661, in do_init
    self._generate_backref()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 2147, in _generate_backref
    self._add_reverse_property(self.back_populates)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 1592, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2524, in get_property
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:04,772 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2522, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'farm_shares'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4255, in _do_configure_registries
    mapper._post_configure_properties()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2418, in _post_configure_properties
    prop.init()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/interfaces.py", line 589, in init
    self.do_init()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 1661, in do_init
    self._generate_backref()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 2147, in _generate_backref
    self._add_reverse_property(self.back_populates)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 1592, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2524, in get_property
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:05,157 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:05,158 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:05,459 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:05,460 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:05,700 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.8ms
2025-08-02 18:32:05,700 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:32:05,753 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.1ms
2025-08-02 18:32:05,754 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:32:05,806 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.0ms
2025-08-02 18:32:05,807 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:32:05,856 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:05,857 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:06,110 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:06,111 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:06,370 - app.main - ERROR - Error on POST /api/v1/auth/login: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 79, in login
    account = await _get_account_by_email(form_data.username, db)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:06,371 - app.main - ERROR - Unhandled exception on /api/v1/auth/login: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 79, in login
    |     account = await _get_account_by_email(form_data.username, db)
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 79, in login
    account = await _get_account_by_email(form_data.username, db)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:06,614 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.3ms
2025-08-02 18:32:06,614 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:32:06,669 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:06,670 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:36:03,316 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 18:36:03,582 - app.main - ERROR - Error on POST /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:03,596 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:04,294 - app.main - ERROR - Error on POST /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:04,296 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:04,892 - app.main - ERROR - Error on POST /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:04,893 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:05,246 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.8ms
2025-08-02 18:36:05,246 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:36:05,299 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-02 18:36:05,299 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:36:05,347 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.1ms
2025-08-02 18:36:05,348 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:36:05,658 - app.main - ERROR - Error on POST /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:05,659 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:06,259 - app.main - ERROR - Error on POST /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:06,261 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:06,687 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:36:06,687 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  64.3ms
2025-08-02 18:36:06,687 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:36:06,740 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  1.8ms
2025-08-02 18:36:06,740 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:36:07,037 - app.main - ERROR - Error on POST /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:07,038 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:38:44,086 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 18:38:44,360 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  317.0ms
2025-08-02 18:38:44,360 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:38:44,749 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  258.3ms
2025-08-02 18:38:44,750 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:38:45,072 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.4ms
2025-08-02 18:38:45,075 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:38:45,186 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-02 18:38:45,186 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  108.6ms
2025-08-02 18:38:45,186 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-02 18:38:45,271 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.8ms
2025-08-02 18:38:45,272 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:38:45,324 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-02 18:38:45,324 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:38:45,373 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.1ms
2025-08-02 18:38:45,373 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:38:45,682 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  258.7ms
2025-08-02 18:38:45,682 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:38:45,913 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  230.5ms
2025-08-02 18:38:45,913 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-02 18:38:46,240 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  249.7ms
2025-08-02 18:38:46,240 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:38:46,472 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:38:46,473 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  231.7ms
2025-08-02 18:38:46,473 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:38:46,556 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:38:46,557 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  9.8ms
2025-08-02 18:38:46,557 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:38:46,612 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.2ms
2025-08-02 18:38:46,612 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:38:46,921 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  260.1ms
2025-08-02 18:38:46,921 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:40:33,799 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 18:40:34,058 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  301.2ms
2025-08-02 18:40:34,058 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:40:34,465 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  264.2ms
2025-08-02 18:40:34,465 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:40:34,808 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.6ms
2025-08-02 18:40:34,808 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:40:34,821 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-02 18:40:34,822 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  12.7ms
2025-08-02 18:40:34,822 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-02 18:40:34,899 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.9ms
2025-08-02 18:40:34,900 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:34,953 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-02 18:40:34,954 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:35,004 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-02 18:40:35,004 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:35,352 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  268.4ms
2025-08-02 18:40:35,353 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:40:35,583 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  230.3ms
2025-08-02 18:40:35,584 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-02 18:40:35,926 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.3ms
2025-08-02 18:40:35,927 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:40:36,160 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:40:36,161 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  233.4ms
2025-08-02 18:40:36,161 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:40:36,313 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:40:36,313 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  68.9ms
2025-08-02 18:40:36,313 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:40:36,367 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.0ms
2025-08-02 18:40:36,367 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:36,671 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.8ms
2025-08-02 18:40:36,672 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:40:37,168 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-02 18:40:37,220 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 18:40:37,220 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 18:40:37,534 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-02 18:40:37,534 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-02 18:40:38,832 - app.services.dose_manager - INFO - Cancellation response for device devX: {'cancelled': True}
2025-08-02 18:40:39,742 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: no braces at all
2025-08-02 18:40:41,668 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-02 18:40:42,012 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-02 18:40:42,017 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-02 18:40:42,040 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-02 18:40:42,042 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-02 18:40:42,296 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-02 18:40:42,841 - httpx - INFO - HTTP Request: GET https://www.frontiersin.org/journals/plant-science/articles/10.3389/fpls.2024.1357153/full "HTTP/1.1 200 OK"
2025-08-02 18:40:43,006 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-02 18:40:43,008 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-02 18:40:43,887 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-08-02 18:40:43,888 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 18:40:43,888 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 18:40:44,353 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-02 18:40:44,353 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-02 18:40:44,499 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.6ms
2025-08-02 18:40:44,499 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:44,557 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.7ms
2025-08-02 18:40:44,558 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:44,618 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.5ms
2025-08-02 18:40:44,619 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:44,675 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-02 18:40:44,676 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:44,771 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.9ms
2025-08-02 18:40:44,771 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:44,825 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.9ms
2025-08-02 18:40:44,826 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:45,090 - app.main - WARNING - HTTPException Could not validate credentials on /api/v1/devices/dosing
2025-08-02 18:40:45,091 - app.main - INFO - POST /api/v1/devices/dosing  ip=127.0.0.1  device_id=-  401  1.5ms
2025-08-02 18:40:45,091 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/devices/dosing "HTTP/1.1 401 Unauthorized"
2025-08-02 18:40:45,147 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-02 18:40:45,147 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-02 18:43:48,288 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 18:43:48,555 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  308.5ms
2025-08-02 18:43:48,556 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:43:48,946 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  264.3ms
2025-08-02 18:43:48,947 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:43:49,283 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.8ms
2025-08-02 18:43:49,283 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:43:49,301 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-02 18:43:49,301 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  17.1ms
2025-08-02 18:43:49,301 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-02 18:43:49,379 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.8ms
2025-08-02 18:43:49,379 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:43:49,432 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-02 18:43:49,432 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:43:49,480 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-02 18:43:49,481 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:43:49,791 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  264.3ms
2025-08-02 18:43:49,791 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:43:50,023 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  231.3ms
2025-08-02 18:43:50,023 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-02 18:43:50,357 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.5ms
2025-08-02 18:43:50,357 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:43:50,590 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:43:50,590 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  232.0ms
2025-08-02 18:43:50,590 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:43:50,676 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:43:50,676 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  10.3ms
2025-08-02 18:43:50,677 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:43:50,735 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.6ms
2025-08-02 18:43:50,735 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:43:51,042 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  260.7ms
2025-08-02 18:43:51,043 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:51:08,815 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 18:51:09,083 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  313.8ms
2025-08-02 18:51:09,084 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:51:09,501 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  265.3ms
2025-08-02 18:51:09,501 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:51:09,833 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.6ms
2025-08-02 18:51:09,833 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:51:09,850 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-02 18:51:09,850 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  16.4ms
2025-08-02 18:51:09,851 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-02 18:51:09,993 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.8ms
2025-08-02 18:51:09,993 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:51:10,046 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.0ms
2025-08-02 18:51:10,046 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:51:10,093 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.9ms
2025-08-02 18:51:10,093 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:51:10,400 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  261.7ms
2025-08-02 18:51:10,401 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:51:10,633 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  231.8ms
2025-08-02 18:51:10,633 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-02 18:51:10,965 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.2ms
2025-08-02 18:51:10,965 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:51:11,199 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:51:11,199 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  233.2ms
2025-08-02 18:51:11,199 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:51:11,285 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:51:11,285 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  10.0ms
2025-08-02 18:51:11,285 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:51:11,340 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.3ms
2025-08-02 18:51:11,340 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:51:11,656 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  267.0ms
2025-08-02 18:51:11,656 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:44,929 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 18:56:45,193 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  367.4ms
2025-08-02 18:56:45,194 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:45,641 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  246.2ms
2025-08-02 18:56:45,642 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:45,953 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  247.2ms
2025-08-02 18:56:45,953 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:45,972 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-02 18:56:45,972 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  18.0ms
2025-08-02 18:56:45,972 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-02 18:56:46,046 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-02 18:56:46,047 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:56:46,098 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.1ms
2025-08-02 18:56:46,098 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:56:46,162 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  10.9ms
2025-08-02 18:56:46,169 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:56:46,493 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  250.2ms
2025-08-02 18:56:46,493 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:46,729 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  234.9ms
2025-08-02 18:56:46,729 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-02 18:56:47,074 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.6ms
2025-08-02 18:56:47,074 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:47,305 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:56:47,305 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  230.8ms
2025-08-02 18:56:47,305 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:56:47,388 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:56:47,388 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  9.1ms
2025-08-02 18:56:47,388 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:56:47,441 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.2ms
2025-08-02 18:56:47,441 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:56:47,743 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.1ms
2025-08-02 18:56:47,743 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:48,208 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-02 18:56:48,256 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 18:56:48,256 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 18:56:48,510 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-02 18:56:48,510 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-02 18:56:49,560 - app.services.dose_manager - INFO - Cancellation response for device devX: {'cancelled': True}
2025-08-02 18:56:50,321 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: no braces at all
2025-08-02 18:56:52,078 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-02 18:56:52,366 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-02 18:56:52,368 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-02 18:56:52,385 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-02 18:56:52,387 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-02 18:56:52,612 - httpx - INFO - HTTP Request: GET https://www.sciencedirect.com/science/article/pii/S0301479724014737 "HTTP/1.1 403 Forbidden"
2025-08-02 18:56:52,715 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.sciencedirect.com/science/article/pii/S0301479724014737
2025-08-02 18:56:52,732 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-02 18:56:53,385 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-02 18:56:53,386 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-02 18:56:53,538 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-08-02 18:56:53,538 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 18:56:53,538 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 18:56:53,609 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.3ms
2025-08-02 18:56:53,609 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 18:56:54,358 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-02 18:56:54,358 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-02 18:56:54,564 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-02 18:56:54,565 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 18:56:54,938 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  283.9ms
2025-08-02 18:56:54,939 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:55,332 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.7ms
2025-08-02 18:56:55,333 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:55,738 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  259.0ms
2025-08-02 18:56:55,739 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:56,234 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  272.0ms
2025-08-02 18:56:56,234 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:56,627 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.0ms
2025-08-02 18:56:56,628 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:57,062 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  287.6ms
2025-08-02 18:56:57,062 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:57,467 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.7ms
2025-08-02 18:56:57,467 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:57,877 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  258.5ms
2025-08-02 18:56:57,878 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:58,263 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.4ms
2025-08-02 18:56:58,263 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:58,645 - app.main - ERROR - Error on POST /api/v1/devices/dosing: name 'JWTError' is not defined
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    except JWTError:
           ^^^^^^^^
NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
2025-08-02 18:56:58,655 - app.main - ERROR - Unhandled exception on /api/v1/devices/dosing: name 'JWTError' is not defined
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    |     solved_result = await solve_dependencies(
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    |     solved = await call(**solved_result.values)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    |     except JWTError:
    |            ^^^^^^^^
    | NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    except JWTError:
           ^^^^^^^^
NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
2025-08-02 18:56:58,840 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.2ms
2025-08-02 18:56:58,840 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-02 19:00:52,951 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 19:00:53,224 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  322.7ms
2025-08-02 19:00:53,225 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:00:53,899 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  405.4ms
2025-08-02 19:00:53,900 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:00:54,264 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  267.3ms
2025-08-02 19:00:54,264 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:00:54,280 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-02 19:00:54,281 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  15.6ms
2025-08-02 19:00:54,281 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-02 19:00:54,379 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.4ms
2025-08-02 19:00:54,379 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:00:54,465 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.4ms
2025-08-02 19:00:54,466 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:00:54,533 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  2.0ms
2025-08-02 19:00:54,533 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:00:54,869 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  271.5ms
2025-08-02 19:00:54,869 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:00:55,102 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  232.3ms
2025-08-02 19:00:55,102 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-02 19:00:55,462 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.1ms
2025-08-02 19:00:55,462 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:00:55,694 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 19:00:55,694 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  231.7ms
2025-08-02 19:00:55,694 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 19:00:55,850 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 19:00:55,850 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  12.7ms
2025-08-02 19:00:55,850 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 19:00:55,917 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  3.8ms
2025-08-02 19:00:55,917 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:00:56,229 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.4ms
2025-08-02 19:00:56,229 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:00:56,746 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-02 19:00:56,808 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 19:00:56,808 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 19:00:57,162 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-02 19:00:57,162 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-02 19:00:58,263 - app.services.dose_manager - INFO - Cancellation response for device devX: {'cancelled': True}
2025-08-02 19:00:59,047 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: no braces at all
2025-08-02 19:01:00,830 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-02 19:01:01,198 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-02 19:01:01,207 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-02 19:01:01,207 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-02 19:01:01,212 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-02 19:01:01,562 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-02 19:01:02,374 - httpx - INFO - HTTP Request: GET https://www.frontiersin.org/journals/plant-science/articles/10.3389/fpls.2024.1357153/full "HTTP/1.1 200 OK"
2025-08-02 19:01:02,479 - httpx - INFO - HTTP Request: GET https://cordis.europa.eu/project/id/613781/reporting "HTTP/1.1 200 OK"
2025-08-02 19:01:04,730 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-08-02 19:01:04,734 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 19:01:04,734 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 19:01:04,809 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.6ms
2025-08-02 19:01:04,810 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:01:05,376 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-02 19:01:05,377 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-02 19:01:05,556 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-02 19:01:05,557 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:01:05,862 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.8ms
2025-08-02 19:01:05,863 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:01:06,222 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  283.6ms
2025-08-02 19:01:06,222 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:06,600 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  250.2ms
2025-08-02 19:01:06,601 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:06,984 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.1ms
2025-08-02 19:01:06,985 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:07,377 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  250.6ms
2025-08-02 19:01:07,377 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:07,710 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  240.1ms
2025-08-02 19:01:07,711 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:08,110 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  270.5ms
2025-08-02 19:01:08,111 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:08,485 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  236.6ms
2025-08-02 19:01:08,486 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:08,814 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  235.4ms
2025-08-02 19:01:08,814 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:09,187 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  250.1ms
2025-08-02 19:01:09,187 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:09,535 - app.main - ERROR - Error on POST /api/v1/devices/dosing: name 'JWTError' is not defined
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    except JWTError:
           ^^^^^^^^
NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
2025-08-02 19:01:09,544 - app.main - ERROR - Unhandled exception on /api/v1/devices/dosing: name 'JWTError' is not defined
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    |     solved_result = await solve_dependencies(
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    |     solved = await call(**solved_result.values)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    |     except JWTError:
    |            ^^^^^^^^
    | NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    except JWTError:
           ^^^^^^^^
NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
2025-08-02 19:01:09,724 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.2ms
2025-08-02 19:01:09,725 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-02 19:13:31,041 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 19:13:31,359 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  360.4ms
2025-08-02 19:13:31,360 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:31,908 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  266.5ms
2025-08-02 19:13:31,908 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:32,274 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  264.6ms
2025-08-02 19:13:32,274 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:32,287 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-02 19:13:32,287 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  13.0ms
2025-08-02 19:13:32,288 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-02 19:13:32,406 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.9ms
2025-08-02 19:13:32,407 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:13:32,588 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-02 19:13:32,588 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:13:32,674 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  2.0ms
2025-08-02 19:13:32,675 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:13:33,010 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  272.3ms
2025-08-02 19:13:33,010 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:33,239 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  228.1ms
2025-08-02 19:13:33,239 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-02 19:13:33,603 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  259.5ms
2025-08-02 19:13:33,603 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:33,841 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 19:13:33,841 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  237.4ms
2025-08-02 19:13:33,842 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 19:13:33,971 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 19:13:33,971 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  10.2ms
2025-08-02 19:13:33,972 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 19:13:34,047 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.7ms
2025-08-02 19:13:34,048 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:13:34,373 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  263.2ms
2025-08-02 19:13:34,373 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:34,972 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-02 19:13:35,028 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 19:13:35,028 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 19:13:35,328 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-02 19:13:35,328 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-02 19:13:36,552 - app.services.dose_manager - INFO - Cancellation response for device devX: {'cancelled': True}
2025-08-02 19:13:37,321 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: no braces at all
2025-08-02 19:13:40,058 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-02 19:13:40,381 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-02 19:13:40,395 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-02 19:13:40,418 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-02 19:13:40,418 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-02 19:13:40,707 - httpx - INFO - HTTP Request: GET https://www.sciencedirect.com/science/article/pii/S0301479724014737 "HTTP/1.1 403 Forbidden"
2025-08-02 19:13:40,733 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-02 19:13:40,842 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.sciencedirect.com/science/article/pii/S0301479724014737
2025-08-02 19:13:41,374 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-02 19:13:41,375 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-02 19:13:41,710 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-08-02 19:13:41,710 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 19:13:41,710 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 19:13:41,766 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.5ms
2025-08-02 19:13:41,766 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:13:42,286 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-02 19:13:42,286 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-02 19:13:42,488 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.3ms
2025-08-02 19:13:42,488 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:13:42,756 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-02 19:13:42,756 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:13:43,118 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  298.5ms
2025-08-02 19:13:43,118 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:43,485 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.2ms
2025-08-02 19:13:43,486 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:43,856 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.8ms
2025-08-02 19:13:43,856 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:44,208 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  248.3ms
2025-08-02 19:13:44,208 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:44,561 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  248.4ms
2025-08-02 19:13:44,562 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:44,934 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.6ms
2025-08-02 19:13:44,934 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:45,307 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.8ms
2025-08-02 19:13:45,307 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:45,681 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.5ms
2025-08-02 19:13:45,682 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:46,059 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.5ms
2025-08-02 19:13:46,059 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:46,389 - app.main - ERROR - Error on POST /api/v1/devices/dosing: name 'JWTError' is not defined
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    except JWTError:
           ^^^^^^^^
NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
2025-08-02 19:13:46,397 - app.main - ERROR - Unhandled exception on /api/v1/devices/dosing: name 'JWTError' is not defined
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    |     solved_result = await solve_dependencies(
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    |     solved = await call(**solved_result.values)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    |     except JWTError:
    |            ^^^^^^^^
    | NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    except JWTError:
           ^^^^^^^^
NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
2025-08-02 19:13:46,569 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.2ms
2025-08-02 19:13:46,570 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-02 19:15:50,557 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 19:15:50,830 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  314.9ms
2025-08-02 19:15:50,830 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:15:51,254 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  264.4ms
2025-08-02 19:15:51,255 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:15:51,587 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.3ms
2025-08-02 19:15:51,588 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:15:51,602 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-02 19:15:51,603 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  14.4ms
2025-08-02 19:15:51,603 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-02 19:15:51,685 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.0ms
2025-08-02 19:15:51,685 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:15:51,739 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-02 19:15:51,740 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:15:51,791 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-02 19:15:51,791 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:15:52,107 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  267.5ms
2025-08-02 19:15:52,108 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:15:52,341 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  233.0ms
2025-08-02 19:15:52,342 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-02 19:15:52,697 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.0ms
2025-08-02 19:15:52,697 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:15:52,929 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 19:15:52,929 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  231.6ms
2025-08-02 19:15:52,930 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 19:15:53,011 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 19:15:53,011 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  9.1ms
2025-08-02 19:15:53,012 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 19:15:53,068 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.3ms
2025-08-02 19:15:53,068 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:15:53,373 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.5ms
2025-08-02 19:15:53,373 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:15:53,939 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-02 19:15:53,991 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 19:15:53,991 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 19:15:54,265 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-02 19:15:54,265 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-02 19:15:55,709 - app.services.dose_manager - INFO - Cancellation response for device devX: {'cancelled': True}
2025-08-02 19:15:56,816 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: no braces at all
2025-08-02 19:15:59,052 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-02 19:15:59,445 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-02 19:15:59,449 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-02 19:15:59,451 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-02 19:15:59,463 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-02 19:15:59,538 - httpx - INFO - HTTP Request: GET https://www.sciencedirect.com/science/article/pii/S0301479724014737 "HTTP/1.1 403 Forbidden"
2025-08-02 19:15:59,679 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.sciencedirect.com/science/article/pii/S0301479724014737
2025-08-02 19:15:59,791 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-02 19:16:00,388 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-02 19:16:00,390 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-02 19:16:00,809 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-08-02 19:16:00,809 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 19:16:00,809 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 19:16:00,965 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  1.9ms
2025-08-02 19:16:00,967 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:16:01,665 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-02 19:16:01,666 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-02 19:16:01,862 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.5ms
2025-08-02 19:16:01,862 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:16:02,121 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.8ms
2025-08-02 19:16:02,121 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:16:02,450 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  270.9ms
2025-08-02 19:16:02,450 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:16:02,811 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.7ms
2025-08-02 19:16:02,811 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:16:03,186 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.9ms
2025-08-02 19:16:03,186 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:16:03,615 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  264.3ms
2025-08-02 19:16:03,615 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:16:03,986 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.7ms
2025-08-02 19:16:03,987 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:16:04,360 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.9ms
2025-08-02 19:16:04,360 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:16:04,735 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.2ms
2025-08-02 19:16:04,736 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:16:05,084 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  243.9ms
2025-08-02 19:16:05,085 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:16:05,411 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  239.7ms
2025-08-02 19:16:05,411 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:16:06,079 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-02 19:16:06,080 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-02 19:22:00,838 - uvicorn.error - INFO - Started server process [89756]
2025-08-02 19:22:00,839 - uvicorn.error - INFO - Waiting for application startup.
2025-08-02 19:22:00,839 - uvicorn.error - INFO - Application startup complete.
2025-08-02 19:22:00,841 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-08-02 19:22:13,405 - app.main - INFO - GET /api/v1/docs  ip=127.0.0.1  device_id=-  200  1.0ms
2025-08-02 19:22:13,951 - app.main - INFO - GET /api/v1/openapi.json  ip=127.0.0.1  device_id=-  200  30.8ms
2025-08-02 19:23:15,910 - uvicorn.error - INFO - Shutting down
2025-08-02 19:23:16,020 - uvicorn.error - INFO - Waiting for application shutdown.
2025-08-02 19:23:16,024 - uvicorn.error - INFO - Application shutdown complete.
2025-08-02 19:23:16,025 - uvicorn.error - INFO - Finished server process [89756]
2025-08-02 19:23:36,264 - uvicorn.error - INFO - Started server process [90026]
2025-08-02 19:23:36,265 - uvicorn.error - INFO - Waiting for application startup.
2025-08-02 19:23:36,267 - uvicorn.error - INFO - Application startup complete.
2025-08-02 19:23:36,271 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-08-02 19:23:37,732 - app.main - INFO - GET /api/v1/docs  ip=127.0.0.1  device_id=-  200  1.8ms
2025-08-02 19:23:38,042 - app.main - INFO - GET /api/v1/openapi.json  ip=127.0.0.1  device_id=-  200  40.0ms
2025-08-02 19:23:58,469 - uvicorn.error - INFO - Shutting down
2025-08-02 19:23:58,579 - uvicorn.error - INFO - Finished server process [90026]
2025-08-02 19:23:58,594 - uvicorn.error - ERROR - Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 1512, in uvloop.loop.Loop.run_until_complete
  File "uvloop/loop.pyx", line 1505, in uvloop.loop.Loop.run_until_complete
  File "uvloop/loop.pyx", line 1379, in uvloop.loop.Loop.run_forever
  File "uvloop/loop.pyx", line 557, in uvloop.loop.Loop._run
  File "uvloop/loop.pyx", line 476, in uvloop.loop.Loop._on_idle
  File "uvloop/cbhandles.pyx", line 83, in uvloop.loop.Handle._run
  File "uvloop/cbhandles.pyx", line 63, in uvloop.loop.Handle._run
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/uvicorn/server.py", line 69, in serve
    with self.capture_signals():
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/uvicorn/server.py", line 330, in capture_signals
    signal.raise_signal(captured_signal)
  File "/opt/homebrew/anaconda3/lib/python3.12/asyncio/runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 699, in lifespan
    await receive()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/asyncio/queues.py", line 158, in get
    await getter
asyncio.exceptions.CancelledError

2025-08-02 19:24:02,147 - uvicorn.error - INFO - Started server process [90185]
2025-08-02 19:24:02,148 - uvicorn.error - INFO - Waiting for application startup.
2025-08-02 19:24:02,149 - uvicorn.error - INFO - Application startup complete.
2025-08-02 19:24:02,151 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-08-02 19:25:31,356 - uvicorn.error - INFO - Shutting down
2025-08-02 19:25:31,467 - uvicorn.error - INFO - Finished server process [90185]
2025-08-02 19:25:31,483 - uvicorn.error - ERROR - Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 1512, in uvloop.loop.Loop.run_until_complete
  File "uvloop/loop.pyx", line 1505, in uvloop.loop.Loop.run_until_complete
  File "uvloop/loop.pyx", line 1379, in uvloop.loop.Loop.run_forever
  File "uvloop/loop.pyx", line 557, in uvloop.loop.Loop._run
  File "uvloop/loop.pyx", line 476, in uvloop.loop.Loop._on_idle
  File "uvloop/cbhandles.pyx", line 83, in uvloop.loop.Handle._run
  File "uvloop/cbhandles.pyx", line 63, in uvloop.loop.Handle._run
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/uvicorn/server.py", line 69, in serve
    with self.capture_signals():
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/uvicorn/server.py", line 330, in capture_signals
    signal.raise_signal(captured_signal)
  File "/opt/homebrew/anaconda3/lib/python3.12/asyncio/runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 699, in lifespan
    await receive()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/asyncio/queues.py", line 158, in get
    await getter
asyncio.exceptions.CancelledError

2025-08-02 19:25:34,604 - uvicorn.error - INFO - Started server process [90306]
2025-08-02 19:25:34,604 - uvicorn.error - INFO - Waiting for application startup.
2025-08-02 19:25:34,605 - uvicorn.error - INFO - Application startup complete.
2025-08-02 19:25:34,605 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-08-02 19:25:34,998 - app.main - INFO - GET /api/v1/docs  ip=127.0.0.1  device_id=-  200  0.9ms
2025-08-02 19:25:35,549 - app.main - INFO - GET /api/v1/openapi.json  ip=127.0.0.1  device_id=-  200  22.8ms
2025-08-02 19:26:10,795 - app.main - INFO - GET /api/v1/docs  ip=127.0.0.1  device_id=-  200  15.4ms
2025-08-02 19:26:10,999 - app.main - INFO - GET /api/v1/openapi.json  ip=127.0.0.1  device_id=-  200  1.7ms
2025-08-02 19:27:27,332 - app.main - INFO - GET /api/v1/docs  ip=127.0.0.1  device_id=-  200  1.7ms
2025-08-02 19:27:27,412 - app.main - INFO - GET /api/v1/openapi.json  ip=127.0.0.1  device_id=-  200  4.7ms
2025-08-02 19:27:30,405 - uvicorn.error - INFO - Shutting down
2025-08-02 19:27:30,509 - uvicorn.error - INFO - Waiting for application shutdown.
2025-08-02 19:27:30,512 - uvicorn.error - INFO - Application shutdown complete.
2025-08-02 19:27:30,513 - uvicorn.error - INFO - Finished server process [90306]
2025-08-02 19:27:34,254 - uvicorn.error - INFO - Started server process [90469]
2025-08-02 19:27:34,255 - uvicorn.error - INFO - Waiting for application startup.
2025-08-02 19:27:34,255 - uvicorn.error - INFO - Application startup complete.
2025-08-02 19:27:34,255 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-08-02 19:27:35,706 - app.main - INFO - GET /api/v1/docs  ip=127.0.0.1  device_id=-  200  0.7ms
2025-08-02 19:27:35,774 - app.main - INFO - GET /api/v1/openapi.json  ip=127.0.0.1  device_id=-  200  27.2ms
2025-08-02 19:28:01,867 - uvicorn.error - INFO - Shutting down
2025-08-02 19:28:01,975 - uvicorn.error - INFO - Waiting for application shutdown.
2025-08-02 19:28:01,978 - uvicorn.error - INFO - Application shutdown complete.
2025-08-02 19:28:01,979 - uvicorn.error - INFO - Finished server process [90469]
2025-08-02 19:29:52,272 - uvicorn.error - INFO - Will watch for changes in these directories: ['/Users/saswatpandey/hydroleaf']
2025-08-02 19:29:52,274 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-08-02 19:29:52,274 - uvicorn.error - INFO - Started reloader process [90978] using WatchFiles
2025-08-02 19:29:53,883 - uvicorn.error - INFO - Started server process [90983]
2025-08-02 19:29:53,883 - uvicorn.error - INFO - Waiting for application startup.
2025-08-02 19:29:53,885 - uvicorn.error - INFO - Application startup complete.
2025-08-02 19:30:01,958 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:30:01,962 - uvicorn.error - WARNING - WatchFiles detected changes in 'app/main.py'. Reloading...
2025-08-02 19:30:01,970 - uvicorn.error - INFO - Shutting down
2025-08-02 19:30:02,080 - uvicorn.error - INFO - Waiting for application shutdown.
2025-08-02 19:30:02,082 - uvicorn.error - INFO - Application shutdown complete.
2025-08-02 19:30:02,083 - uvicorn.error - INFO - Finished server process [90983]
2025-08-02 19:30:02,852 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:30:03,217 - watchfiles.main - INFO - 3 changes detected
2025-08-02 19:30:04,622 - uvicorn.error - INFO - Started server process [90992]
2025-08-02 19:30:04,622 - uvicorn.error - INFO - Waiting for application startup.
2025-08-02 19:30:04,622 - uvicorn.error - INFO - Application startup complete.
2025-08-02 19:30:11,520 - app.main - INFO - GET /api/v1/docs  ip=127.0.0.1  device_id=-  200  1.7ms
2025-08-02 19:30:11,605 - app.main - INFO - GET /api/v1/openapi.json  ip=127.0.0.1  device_id=-  200  26.2ms
2025-08-02 19:30:34,190 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:30:34,196 - uvicorn.error - WARNING - WatchFiles detected changes in 'app/routers/subscriptions.py'. Reloading...
2025-08-02 19:30:34,283 - uvicorn.error - INFO - Shutting down
2025-08-02 19:30:34,393 - uvicorn.error - INFO - Waiting for application shutdown.
2025-08-02 19:30:34,407 - uvicorn.error - INFO - Application shutdown complete.
2025-08-02 19:30:34,409 - uvicorn.error - INFO - Finished server process [90992]
2025-08-02 19:30:35,159 - watchfiles.main - INFO - 2 changes detected
2025-08-02 19:30:35,160 - uvicorn.error - WARNING - WatchFiles detected changes in 'app/routers/subscriptions.py'. Reloading...
2025-08-02 19:30:37,207 - uvicorn.error - INFO - Started server process [91028]
2025-08-02 19:30:37,208 - uvicorn.error - INFO - Waiting for application startup.
2025-08-02 19:30:37,208 - uvicorn.error - INFO - Application startup complete.
2025-08-02 19:30:37,253 - watchfiles.main - INFO - 3 changes detected
2025-08-02 19:30:38,947 - app.main - INFO - GET /api/v1/docs  ip=127.0.0.1  device_id=-  200  0.7ms
2025-08-02 19:30:39,335 - app.main - INFO - GET /api/v1/openapi.json  ip=127.0.0.1  device_id=-  200  34.3ms
2025-08-02 19:31:00,575 - watchfiles.main - INFO - 3 changes detected
2025-08-02 19:31:02,408 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:02,509 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 19:31:02,776 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  317.3ms
2025-08-02 19:31:02,777 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:31:02,879 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:03,271 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  273.0ms
2025-08-02 19:31:03,272 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:31:03,348 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:03,609 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.4ms
2025-08-02 19:31:03,609 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:31:03,621 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-02 19:31:03,621 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  11.9ms
2025-08-02 19:31:03,622 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-02 19:31:03,701 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-02 19:31:03,701 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:31:03,705 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:03,759 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.7ms
2025-08-02 19:31:03,759 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:31:03,811 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.0ms
2025-08-02 19:31:03,811 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:31:04,070 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:04,120 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  259.0ms
2025-08-02 19:31:04,120 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:31:04,350 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  229.5ms
2025-08-02 19:31:04,350 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-02 19:31:04,435 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:04,689 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.9ms
2025-08-02 19:31:04,689 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:31:04,919 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 19:31:04,919 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  229.4ms
2025-08-02 19:31:04,919 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 19:31:05,016 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:05,018 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 19:31:05,019 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  10.6ms
2025-08-02 19:31:05,019 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 19:31:05,079 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  3.1ms
2025-08-02 19:31:05,079 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:31:05,381 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:05,395 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  265.0ms
2025-08-02 19:31:05,395 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:31:05,801 - watchfiles.main - INFO - 5 changes detected
2025-08-02 19:31:05,887 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-02 19:31:05,941 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 19:31:05,941 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 19:31:06,161 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:06,223 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-02 19:31:06,223 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-02 19:31:06,522 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:06,880 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:07,242 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:07,578 - app.services.dose_manager - INFO - Cancellation response for device devX: {'cancelled': True}
2025-08-02 19:31:07,599 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:07,961 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:08,323 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:08,630 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: no braces at all
2025-08-02 19:31:08,688 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:09,049 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:10,631 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-02 19:31:10,955 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-02 19:31:10,958 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-02 19:31:10,969 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-02 19:31:10,971 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-02 19:31:11,364 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-02 19:31:11,888 - httpx - INFO - HTTP Request: GET https://www.frontiersin.org/journals/plant-science/articles/10.3389/fpls.2024.1357153/full "HTTP/1.1 200 OK"
2025-08-02 19:31:11,970 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-02 19:31:11,972 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-02 19:31:12,507 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:12,585 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-08-02 19:31:12,586 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 19:31:12,586 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 19:31:12,670 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  3.1ms
2025-08-02 19:31:12,670 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:31:12,869 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:13,209 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-02 19:31:13,210 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-02 19:31:13,232 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:13,401 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-02 19:31:13,401 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:31:13,590 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:13,705 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.8ms
2025-08-02 19:31:13,706 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:31:13,953 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:14,035 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  269.7ms
2025-08-02 19:31:14,035 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:31:14,399 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  248.0ms
2025-08-02 19:31:14,399 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:31:14,774 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.6ms
2025-08-02 19:31:14,774 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:31:15,157 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.9ms
2025-08-02 19:31:15,157 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:31:15,529 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.7ms
2025-08-02 19:31:15,530 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:31:15,917 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.5ms
2025-08-02 19:31:15,917 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:31:16,291 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.1ms
2025-08-02 19:31:16,291 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:31:16,664 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.3ms
2025-08-02 19:31:16,664 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:31:17,036 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.4ms
2025-08-02 19:31:17,037 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:31:17,286 - watchfiles.main - INFO - 1 change detected
2025-08-02 19:31:17,562 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.2ms
2025-08-02 19:31:17,562 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-02 19:31:17,699 - watchfiles.main - INFO - 3 changes detected
2025-08-02 19:31:18,063 - watchfiles.main - INFO - 2 changes detected
2025-08-07 19:21:52,777 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-07 19:21:53,047 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  318.8ms
2025-08-07 19:21:53,047 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:21:53,540 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  270.7ms
2025-08-07 19:21:53,541 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:21:53,897 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.7ms
2025-08-07 19:21:53,897 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:21:53,910 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-07 19:21:53,910 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  12.3ms
2025-08-07 19:21:53,910 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-07 19:21:54,008 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.0ms
2025-08-07 19:21:54,008 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-07 19:21:54,074 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.5ms
2025-08-07 19:21:54,074 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-07 19:21:54,135 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.5ms
2025-08-07 19:21:54,135 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-07 19:21:54,477 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  260.1ms
2025-08-07 19:21:54,477 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:21:54,708 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  230.2ms
2025-08-07 19:21:54,708 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-07 19:21:55,065 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.7ms
2025-08-07 19:21:55,065 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:21:55,297 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-07 19:21:55,297 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  231.7ms
2025-08-07 19:21:55,297 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-07 19:21:55,410 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-07 19:21:55,410 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  9.7ms
2025-08-07 19:21:55,411 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-07 19:21:55,478 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.6ms
2025-08-07 19:21:55,478 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-07 19:21:55,814 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  266.8ms
2025-08-07 19:21:55,814 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:32:32,875 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: no braces at all
2025-08-07 19:32:35,754 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-07 19:32:36,361 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-07 19:32:36,369 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-07 19:32:36,391 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-07 19:32:36,392 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-07 19:32:36,592 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-07 19:32:37,290 - httpx - INFO - HTTP Request: GET https://www.frontiersin.org/journals/plant-science/articles/10.3389/fpls.2024.1357153/full "HTTP/1.1 200 OK"
2025-08-07 19:32:37,680 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-07 19:32:37,682 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-07 19:32:38,051 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-08-07 19:32:38,052 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-07 19:32:38,052 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-07 19:40:13,642 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-07 19:40:13,908 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  306.8ms
2025-08-07 19:40:13,908 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:40:14,327 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  264.8ms
2025-08-07 19:40:14,327 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:40:14,661 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.0ms
2025-08-07 19:40:14,662 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:40:14,677 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-07 19:40:14,677 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  14.6ms
2025-08-07 19:40:14,677 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-07 19:40:14,755 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.1ms
2025-08-07 19:40:14,756 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-07 19:40:14,810 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-07 19:40:14,810 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-07 19:40:14,858 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-07 19:40:14,858 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-07 19:40:15,168 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  263.6ms
2025-08-07 19:40:15,168 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:40:15,400 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  231.3ms
2025-08-07 19:40:15,400 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-07 19:40:15,734 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.7ms
2025-08-07 19:40:15,734 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:40:15,965 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-07 19:40:15,966 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  230.8ms
2025-08-07 19:40:15,966 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-07 19:40:16,060 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-07 19:40:16,060 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  10.4ms
2025-08-07 19:40:16,060 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-07 19:40:16,116 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.5ms
2025-08-07 19:40:16,116 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-07 19:40:16,426 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  261.9ms
2025-08-07 19:40:16,426 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:40:16,922 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-07 19:40:16,971 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-07 19:40:16,971 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-07 19:40:17,221 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-07 19:40:17,222 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-07 19:40:18,503 - app.services.dose_manager - INFO - Cancellation response for device devX: {'cancelled': True}
2025-08-07 19:40:19,383 - app.services.llm - ERROR - Malformed JSON from OpenAI: {'k':4,'l':[5,6]}
```
suffix {"m":7}
2025-08-07 19:40:19,510 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: definitely no braces
2025-08-07 19:40:21,779 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-07 19:40:22,311 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-07 19:40:22,316 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-07 19:40:22,684 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-07 19:40:23,035 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-07 19:40:23,037 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-07 19:40:23,252 - httpx - INFO - HTTP Request: GET https://www.frontiersin.org/journals/plant-science/articles/10.3389/fpls.2024.1357153/full "HTTP/1.1 200 OK"
2025-08-07 19:40:23,268 - httpx - INFO - HTTP Request: GET https://cordis.europa.eu/project/id/613781/reporting "HTTP/1.1 200 OK"
2025-08-07 19:40:24,398 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-07 19:40:24,454 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.2ms
2025-08-07 19:40:24,454 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-07 19:40:25,044 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-07 19:40:25,045 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-07 19:40:25,282 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-07 19:40:25,282 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-07 19:40:25,686 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.7ms
2025-08-07 19:40:25,686 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-07 19:40:26,048 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  269.9ms
2025-08-07 19:40:26,048 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:40:26,436 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  259.4ms
2025-08-07 19:40:26,436 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:40:26,800 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  249.0ms
2025-08-07 19:40:26,800 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:40:27,153 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  247.9ms
2025-08-07 19:40:27,153 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:40:27,526 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  250.0ms
2025-08-07 19:40:27,526 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:40:27,907 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.2ms
2025-08-07 19:40:27,907 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:40:28,294 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.4ms
2025-08-07 19:40:28,294 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:40:28,698 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  271.2ms
2025-08-07 19:40:28,698 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:40:29,123 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  263.1ms
2025-08-07 19:40:29,123 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 19:40:29,775 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.5ms
2025-08-07 19:40:29,776 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-07 23:38:40,994 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-07 23:38:41,265 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  330.0ms
2025-08-07 23:38:41,266 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 23:38:41,763 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  267.9ms
2025-08-07 23:38:41,764 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 23:38:42,241 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  364.6ms
2025-08-07 23:38:42,242 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 23:38:42,253 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-07 23:38:42,253 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  11.2ms
2025-08-07 23:38:42,254 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-07 23:38:42,368 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.6ms
2025-08-07 23:38:42,368 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-07 23:38:42,447 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.8ms
2025-08-07 23:38:42,448 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-07 23:38:42,529 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.4ms
2025-08-07 23:38:42,529 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-07 23:38:42,891 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  276.1ms
2025-08-07 23:38:42,892 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 23:38:43,123 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  230.9ms
2025-08-07 23:38:43,123 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-07 23:38:43,484 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.7ms
2025-08-07 23:38:43,484 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 23:38:43,712 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-07 23:38:43,712 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  227.5ms
2025-08-07 23:38:43,712 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-07 23:38:44,003 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-07 23:38:44,003 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  22.8ms
2025-08-07 23:38:44,003 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-07 23:38:44,097 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  5.0ms
2025-08-07 23:38:44,097 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-07 23:38:44,596 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  354.2ms
2025-08-07 23:38:44,597 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 23:38:45,247 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-07 23:38:45,395 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-07 23:38:45,475 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-07 23:38:45,475 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-07 23:38:45,961 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-07 23:38:45,961 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-07 23:38:46,423 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-07 23:38:46,526 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-07 23:38:46,624 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-07 23:38:46,712 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-07 23:38:46,798 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/monitor "HTTP/1.1 200 OK"
2025-08-07 23:38:46,975 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 422 Unprocessable Entity"
2025-08-07 23:38:47,065 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 200 OK"
2025-08-07 23:38:47,150 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 200 OK"
2025-08-07 23:38:47,237 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 200 OK"
2025-08-07 23:38:47,439 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-07 23:38:48,045 - app.services.dose_manager - INFO - Cancellation response for device devX: {'cancelled': True}
2025-08-07 23:38:49,270 - app.services.llm - ERROR - Malformed JSON from OpenAI: {'k':4,'l':[5,6]}
```
suffix {"m":7}
2025-08-07 23:38:49,402 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: definitely no braces
2025-08-07 23:38:51,686 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-07 23:38:52,093 - httpx - INFO - HTTP Request: GET https://www.sciencedirect.com/science/article/pii/S0304423824004990 "HTTP/1.1 403 Forbidden"
2025-08-07 23:38:52,188 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.sciencedirect.com/science/article/pii/S0304423824004990
2025-08-07 23:38:52,293 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-07 23:38:52,302 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-07 23:38:52,395 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-07 23:38:52,397 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-07 23:38:52,478 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-07 23:38:53,626 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-07 23:38:53,627 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-07 23:38:54,011 - app.services.llm - ERROR - Malformed JSON from OpenAI: {'a':1}
```
some text
```analysis
{'b':2}
2025-08-07 23:38:54,226 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.8ms
2025-08-07 23:38:54,226 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-07 23:38:55,066 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-07 23:38:55,067 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-07 23:38:55,236 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-07 23:38:55,236 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-07 23:38:55,493 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-07 23:38:56,495 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-07 23:38:58,496 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-07 23:38:58,602 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-07 23:38:59,605 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-07 23:39:01,608 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-07 23:39:01,755 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-07 23:39:02,756 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-07 23:39:04,758 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-07 23:39:04,917 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-07 23:39:05,919 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-07 23:39:07,921 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-07 23:39:08,057 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-07 23:39:09,061 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-07 23:39:11,063 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-07 23:39:11,203 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  1.0ms
2025-08-07 23:39:11,203 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-07 23:39:11,527 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.7ms
2025-08-07 23:39:11,528 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-07 23:39:11,888 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  284.4ms
2025-08-07 23:39:11,889 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 23:39:12,284 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.0ms
2025-08-07 23:39:12,284 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 23:39:12,682 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.3ms
2025-08-07 23:39:12,682 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 23:39:13,076 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.6ms
2025-08-07 23:39:13,077 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 23:39:13,468 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.4ms
2025-08-07 23:39:13,468 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 23:39:13,848 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  249.7ms
2025-08-07 23:39:13,848 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 23:39:14,241 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.6ms
2025-08-07 23:39:14,241 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 23:39:14,632 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.1ms
2025-08-07 23:39:14,632 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 23:39:15,017 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.9ms
2025-08-07 23:39:15,018 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-07 23:39:15,239 - app.services.supply_chain_service - ERROR - JSON Parsing Error: Expecting ',' delimiter: line 1 column 38 (char 37). Response: foo {"outer":{"inner":123,"list":[1,2,3]}} bar
2025-08-07 23:39:15,353 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-07 23:39:15,402 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-07 23:39:15,995 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-07 23:39:15,996 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 01:14:08,910 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 01:14:08,984 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:14:08,985 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:14:09,069 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 01:14:09,141 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:14:09,161 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:14:09,162 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:14:09,238 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/monitor "HTTP/1.1 200 OK"
2025-08-08 01:14:09,388 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 200 OK"
2025-08-08 01:14:09,405 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose_monitor "HTTP/1.1 200 OK"
2025-08-08 01:14:09,484 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 200 OK"
2025-08-08 01:14:09,561 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:14:09,646 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:14:09,860 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 01:14:10,836 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-08 01:14:10,837 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 01:22:48,014 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 01:22:48,130 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:22:48,132 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:22:48,248 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 01:22:48,343 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:22:48,363 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:22:48,364 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:22:48,472 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/monitor "HTTP/1.1 200 OK"
2025-08-08 01:22:48,673 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 200 OK"
2025-08-08 01:22:48,694 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose_monitor "HTTP/1.1 200 OK"
2025-08-08 01:22:48,782 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 200 OK"
2025-08-08 01:22:48,877 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:22:48,992 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:22:49,328 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 01:22:50,158 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.3ms
2025-08-08 01:22:50,159 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 01:39:13,285 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 01:39:13,371 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:39:13,373 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:39:13,492 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 01:39:13,570 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:39:13,587 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:39:13,588 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:39:13,664 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/monitor "HTTP/1.1 200 OK"
2025-08-08 01:39:13,825 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 200 OK"
2025-08-08 01:39:13,842 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose_monitor "HTTP/1.1 200 OK"
2025-08-08 01:39:13,920 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 200 OK"
2025-08-08 01:39:13,996 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:39:14,080 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 500 Internal Server Error"
2025-08-08 01:39:14,284 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 01:39:15,099 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-08 01:39:15,100 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 02:00:15,875 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-08 02:00:16,136 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  354.6ms
2025-08-08 02:00:16,136 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:00:16,526 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.4ms
2025-08-08 02:00:16,526 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:00:16,865 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.3ms
2025-08-08 02:00:16,865 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:00:16,877 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-08 02:00:16,877 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  11.6ms
2025-08-08 02:00:16,877 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-08 02:00:16,964 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.7ms
2025-08-08 02:00:16,964 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:00:17,023 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.6ms
2025-08-08 02:00:17,024 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:00:17,083 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-08 02:00:17,083 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:00:17,401 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  265.4ms
2025-08-08 02:00:17,402 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:00:17,632 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  229.5ms
2025-08-08 02:00:17,632 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-08 02:00:17,985 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  258.6ms
2025-08-08 02:00:17,986 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:00:18,218 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 02:00:18,218 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  231.7ms
2025-08-08 02:00:18,218 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 02:00:18,325 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 02:00:18,325 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  11.8ms
2025-08-08 02:00:18,325 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 02:00:18,393 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.8ms
2025-08-08 02:00:18,394 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:00:18,722 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  267.2ms
2025-08-08 02:00:18,723 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:00:19,296 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 02:00:19,451 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 02:00:19,527 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-08 02:00:19,528 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-08 02:00:19,980 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-08 02:00:19,980 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-08 02:00:20,494 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 02:00:20,593 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 02:00:20,744 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 02:00:20,829 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 02:00:21,255 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 200 OK"
2025-08-08 02:00:21,350 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 200 OK"
2025-08-08 02:00:21,545 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 02:00:21,632 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8003/toggle "HTTP/1.1 200 OK"
2025-08-08 02:00:21,778 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8004/status "HTTP/1.1 200 OK"
2025-08-08 02:00:22,797 - app.services.dose_manager - INFO - Cancellation response for device devX: {'cancelled': True}
2025-08-08 02:00:24,049 - app.services.llm - ERROR - Malformed JSON from OpenAI: {'k':4,'l':[5,6]}
```
suffix {"m":7}
2025-08-08 02:00:24,200 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: definitely no braces
2025-08-08 02:00:26,873 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 02:00:27,415 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-08 02:00:27,417 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-08 02:00:27,420 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-08 02:00:27,420 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-08 02:00:27,737 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-08 02:00:27,984 - httpx - INFO - HTTP Request: GET https://www.frontiersin.org/journals/plant-science/articles/10.3389/fpls.2024.1357153/full "HTTP/1.1 200 OK"
2025-08-08 02:00:28,344 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-08 02:00:28,345 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-08 02:00:28,738 - app.services.llm - ERROR - Malformed JSON from OpenAI: {'a':1}
```
some text
```analysis
{'b':2}
2025-08-08 02:00:28,910 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.7ms
2025-08-08 02:00:28,911 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 02:00:29,820 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 02:00:29,820 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-08 02:00:30,045 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 02:00:30,045 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-08 02:00:30,352 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:00:31,353 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:00:33,355 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:00:33,486 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:00:34,488 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:00:36,489 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:00:36,638 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:00:37,640 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:00:39,641 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:00:39,771 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:00:40,773 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:00:42,774 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:00:42,923 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:00:43,951 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:00:45,962 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:00:46,121 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.8ms
2025-08-08 02:00:46,121 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 02:00:46,422 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.3ms
2025-08-08 02:00:46,423 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 02:00:46,762 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  276.7ms
2025-08-08 02:00:46,762 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:00:47,138 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.3ms
2025-08-08 02:00:47,138 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:00:47,534 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  269.1ms
2025-08-08 02:00:47,534 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:00:47,975 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  263.0ms
2025-08-08 02:00:47,975 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:00:48,362 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.4ms
2025-08-08 02:00:48,362 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:00:48,752 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.6ms
2025-08-08 02:00:48,752 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:00:49,143 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.9ms
2025-08-08 02:00:49,144 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:00:49,644 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  318.9ms
2025-08-08 02:00:49,644 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:00:50,027 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.3ms
2025-08-08 02:00:50,028 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:00:50,256 - app.services.supply_chain_service - ERROR - JSON Parsing Error: Expecting ',' delimiter: line 1 column 38 (char 37). Response: foo {"outer":{"inner":123,"list":[1,2,3]}} bar
2025-08-08 02:00:50,393 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 02:00:50,451 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 02:00:51,124 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.3ms
2025-08-08 02:00:51,125 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 02:15:45,695 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-08 02:15:45,956 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  358.1ms
2025-08-08 02:15:45,956 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:15:46,389 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.0ms
2025-08-08 02:15:46,389 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:15:46,744 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  258.8ms
2025-08-08 02:15:46,744 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:15:46,759 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-08 02:15:46,760 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  15.1ms
2025-08-08 02:15:46,760 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-08 02:15:46,853 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-08 02:15:46,853 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:15:46,913 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.6ms
2025-08-08 02:15:46,913 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:15:46,973 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.5ms
2025-08-08 02:15:46,974 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:15:47,464 - app.main - ERROR - Error on POST /api/v1/auth/signup: athrow(): asynchronous generator is already running
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 84, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 290, in app
    async with AsyncExitStack() as async_exit_stack:
               ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 754, in __aexit__
    raise exc_details[1]
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 737, in __aexit__
    cb_suppress = await cb(*exc_details)
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 231, in __aexit__
    await self.gen.athrow(value)
RuntimeError: athrow(): asynchronous generator is already running
2025-08-08 02:15:47,476 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: athrow(): asynchronous generator is already running
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 84, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 290, in app
    |     async with AsyncExitStack() as async_exit_stack:
    |                ^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 754, in __aexit__
    |     raise exc_details[1]
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 737, in __aexit__
    |     cb_suppress = await cb(*exc_details)
    |                   ^^^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 231, in __aexit__
    |     await self.gen.athrow(value)
    | RuntimeError: athrow(): asynchronous generator is already running
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 84, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 290, in app
    async with AsyncExitStack() as async_exit_stack:
               ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 754, in __aexit__
    raise exc_details[1]
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 737, in __aexit__
    cb_suppress = await cb(*exc_details)
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 231, in __aexit__
    await self.gen.athrow(value)
RuntimeError: athrow(): asynchronous generator is already running
2025-08-08 02:15:47,485 - asyncio - ERROR - an error occurred during closing of asynchronous generator <async_generator object _setup_db_and_overrides.<locals>._override_get_db at 0x113a2e6c0>
asyncgen: <async_generator object _setup_db_and_overrides.<locals>._override_get_db at 0x113a2e6c0>
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/tests/conftest.py", line 89, in _override_get_db
    yield session
GeneratorExit

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 876, in rollback
    self.await_(self._rollback_and_discard())
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 857, in _rollback_and_discard
    await self._transaction.rollback()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/transaction.py", line 227, in rollback
    await self.__rollback()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/transaction.py", line 206, in __rollback
    await self._connection.execute(query)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 349, in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 360, in query
  File "asyncpg/protocol/protocol.pyx", line 745, in asyncpg.protocol.protocol.BaseProtocol._check_state
asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1125, in _rollback_impl
    self.engine.dialect.do_rollback(self.connection)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 700, in do_rollback
    dbapi_connection.rollback()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 882, in rollback
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/tests/conftest.py", line 92, in _override_get_db
    await session.rollback()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1001, in rollback
    await greenlet_spawn(self.sync_session.rollback)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1994, in rollback
    self._transaction.rollback(_to_root=True)
  File "<string>", line 2, in rollback
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1395, in rollback
    raise rollback_err[1].with_traceback(rollback_err[2])
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1360, in rollback
    t[1].rollback()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2608, in rollback
    self._do_rollback()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2727, in _do_rollback
    self._close_impl(try_deactivate=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2710, in _close_impl
    self._connection_rollback_impl()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2702, in _connection_rollback_impl
    self.connection._rollback_impl()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1127, in _rollback_impl
    self._handle_dbapi_exception(e, None, None, None, None)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1125, in _rollback_impl
    self.engine.dialect.do_rollback(self.connection)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 700, in do_rollback
    dbapi_connection.rollback()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 882, in rollback
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
(Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-08-08 02:15:47,695 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-78' coro=<_wrap_async_fixture.<locals>._async_fixture_wrapper.<locals>.setup() done, defined at /Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/pytest_asyncio/plugin.py:369> exception=RuntimeError('athrow(): asynchronous generator is already running')>
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/pytest_asyncio/plugin.py", line 370, in setup
    |     res = await func(**_add_kwargs(func, kwargs, event_loop, request))
    |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/tests/test_auth.py", line 36, in signed_up_user
    |     resp = await async_client.post(f"{AUTH_URL}/signup", json=payload)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 187, in __call__
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 84, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 290, in app
    |     async with AsyncExitStack() as async_exit_stack:
    |                ^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 754, in __aexit__
    |     raise exc_details[1]
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 737, in __aexit__
    |     cb_suppress = await cb(*exc_details)
    |                   ^^^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 231, in __aexit__
    |     await self.gen.athrow(value)
    | RuntimeError: athrow(): asynchronous generator is already running
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/pytest_asyncio/plugin.py", line 370, in setup
    res = await func(**_add_kwargs(func, kwargs, event_loop, request))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/tests/test_auth.py", line 36, in signed_up_user
    resp = await async_client.post(f"{AUTH_URL}/signup", json=payload)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 84, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 290, in app
    async with AsyncExitStack() as async_exit_stack:
               ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 754, in __aexit__
    raise exc_details[1]
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 737, in __aexit__
    cb_suppress = await cb(*exc_details)
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 231, in __aexit__
    await self.gen.athrow(value)
RuntimeError: athrow(): asynchronous generator is already running
2025-08-08 02:17:56,704 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-08 02:17:56,969 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  356.6ms
2025-08-08 02:17:56,969 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:17:57,344 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  244.3ms
2025-08-08 02:17:57,344 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:17:57,682 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.6ms
2025-08-08 02:17:57,682 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:17:57,694 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-08 02:17:57,694 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  11.1ms
2025-08-08 02:17:57,694 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-08 02:17:57,789 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.0ms
2025-08-08 02:17:57,789 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:17:57,847 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-08 02:17:57,847 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:17:57,906 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-08 02:17:57,907 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:17:58,238 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  276.2ms
2025-08-08 02:17:58,239 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:17:58,471 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  231.9ms
2025-08-08 02:17:58,471 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-08 02:17:58,811 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  248.4ms
2025-08-08 02:17:58,811 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:17:59,047 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 02:17:59,047 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  234.9ms
2025-08-08 02:17:59,047 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 02:17:59,156 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 02:17:59,156 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  9.8ms
2025-08-08 02:17:59,156 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 02:17:59,219 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.4ms
2025-08-08 02:17:59,220 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:17:59,538 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  262.7ms
2025-08-08 02:17:59,538 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:18:00,118 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 02:18:00,237 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 02:18:00,294 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-08 02:18:00,294 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-08 02:18:00,642 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-08 02:18:00,642 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-08 02:18:01,094 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 02:18:01,179 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 02:18:01,259 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 02:18:01,333 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 02:18:01,682 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 200 OK"
2025-08-08 02:18:01,781 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 200 OK"
2025-08-08 02:18:02,061 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 02:18:02,178 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8003/toggle "HTTP/1.1 200 OK"
2025-08-08 02:18:02,360 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8004/status "HTTP/1.1 200 OK"
2025-08-08 02:18:03,570 - app.services.dose_manager - INFO - Cancellation response for device devX: {'cancelled': True}
2025-08-08 02:18:04,696 - app.services.llm - ERROR - Malformed JSON from OpenAI: {'k':4,'l':[5,6]}
```
suffix {"m":7}
2025-08-08 02:18:04,840 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: definitely no braces
2025-08-08 02:18:06,861 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 02:18:07,418 - httpx - INFO - HTTP Request: GET https://www.sciencedirect.com/science/article/pii/S0304423824004990 "HTTP/1.1 403 Forbidden"
2025-08-08 02:18:07,468 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-08 02:18:07,469 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-08 02:18:07,473 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-08 02:18:07,474 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-08 02:18:07,489 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.sciencedirect.com/science/article/pii/S0304423824004990
2025-08-08 02:18:07,591 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-08 02:18:08,159 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-08 02:18:08,161 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-08 02:18:08,924 - app.services.llm - ERROR - Malformed JSON from OpenAI: {'a':1}
```
some text
```analysis
{'b':2}
2025-08-08 02:18:09,193 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-08 02:18:09,194 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 02:18:10,148 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 02:18:10,149 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-08 02:18:10,527 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 02:18:10,527 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-08 02:18:10,902 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:18:11,904 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:18:13,907 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:18:14,068 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:18:15,069 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:18:17,071 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:18:17,334 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:18:18,336 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:18:20,338 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:18:20,529 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:18:21,530 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:18:23,532 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:18:23,704 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:18:24,706 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:18:26,708 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:18:26,866 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  1.1ms
2025-08-08 02:18:26,866 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 02:18:27,253 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.7ms
2025-08-08 02:18:27,254 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 02:18:27,639 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  304.0ms
2025-08-08 02:18:27,639 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:18:28,047 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.0ms
2025-08-08 02:18:28,047 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:18:28,442 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.3ms
2025-08-08 02:18:28,443 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:18:28,841 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.9ms
2025-08-08 02:18:28,842 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:18:29,226 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.4ms
2025-08-08 02:18:29,227 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:18:29,620 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.2ms
2025-08-08 02:18:29,621 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:18:30,010 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.9ms
2025-08-08 02:18:30,010 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:18:30,400 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.7ms
2025-08-08 02:18:30,400 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:18:30,891 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  322.6ms
2025-08-08 02:18:30,891 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:18:31,164 - app.services.supply_chain_service - ERROR - JSON Parsing Error: Expecting ',' delimiter: line 1 column 38 (char 37). Response: foo {"outer":{"inner":123,"list":[1,2,3]}} bar
2025-08-08 02:18:31,306 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 02:18:31,359 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 02:18:31,938 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-08 02:18:31,938 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 02:45:37,061 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-08 02:45:37,328 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  329.2ms
2025-08-08 02:45:37,329 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:45:37,750 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  261.8ms
2025-08-08 02:45:37,751 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:45:38,095 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.7ms
2025-08-08 02:45:38,095 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:45:38,112 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-08 02:45:38,112 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  15.9ms
2025-08-08 02:45:38,112 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-08 02:45:38,215 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-08 02:45:38,215 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:45:38,273 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.5ms
2025-08-08 02:45:38,273 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:45:38,332 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.6ms
2025-08-08 02:45:38,333 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:45:38,656 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  265.9ms
2025-08-08 02:45:38,656 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:45:38,883 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  226.2ms
2025-08-08 02:45:38,883 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-08 02:45:39,227 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.0ms
2025-08-08 02:45:39,227 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:45:39,459 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 02:45:39,459 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  231.5ms
2025-08-08 02:45:39,459 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 02:45:39,573 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 02:45:39,573 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  9.9ms
2025-08-08 02:45:39,574 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 02:45:39,635 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.9ms
2025-08-08 02:45:39,635 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:45:39,964 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  269.5ms
2025-08-08 02:45:39,964 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:45:40,471 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 02:45:40,629 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 02:45:40,686 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-08 02:45:40,686 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-08 02:45:41,019 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-08 02:45:41,019 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-08 02:45:41,543 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 02:45:41,633 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 02:45:41,721 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 02:45:41,801 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 02:45:42,023 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose "HTTP/1.1 404 Not Found"
2025-08-08 02:45:42,131 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dosing/cancel "HTTP/1.1 404 Not Found"
2025-08-08 02:45:43,986 - app.services.dose_manager - INFO - Cancellation response for device devX: {'cancelled': True}
2025-08-08 02:45:45,098 - app.services.llm - ERROR - Malformed JSON from OpenAI: {'k':4,'l':[5,6]}
```
suffix {"m":7}
2025-08-08 02:45:45,253 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: definitely no braces
2025-08-08 02:45:47,678 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 02:45:48,139 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-08 02:45:48,144 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-08 02:45:48,158 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-08 02:45:48,167 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-08 02:45:48,778 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-08 02:45:49,082 - httpx - INFO - HTTP Request: GET https://ec.europa.eu/programmes/erasmus-plus/project-result-content/6585f6b6-4180-4208-9ea9-1efdb43cdf05/LIfe%20from%20Soil%20Modular%20Courses%20EN.pdf "HTTP/1.1 200 "
2025-08-08 02:45:49,083 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-08 02:45:49,086 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-08 02:46:55,482 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 02:46:55,555 - app.services.llm - ERROR - Malformed JSON from OpenAI: {'a':1}
```
some text
```analysis
{'b':2}
2025-08-08 02:46:55,700 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.8ms
2025-08-08 02:46:55,701 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 02:46:56,526 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 02:46:56,527 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-08 02:46:56,698 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 02:46:56,698 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-08 02:46:57,022 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:46:58,024 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:47:00,026 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:47:00,182 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:47:01,183 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:47:03,186 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:47:03,326 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:47:04,328 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:47:06,330 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:47:06,456 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:47:07,458 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:47:09,460 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:47:09,610 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:47:10,612 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:47:12,615 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:47:12,759 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.3ms
2025-08-08 02:47:12,759 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 02:47:13,101 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.6ms
2025-08-08 02:47:13,101 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 02:47:13,436 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  270.2ms
2025-08-08 02:47:13,436 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:47:13,832 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.8ms
2025-08-08 02:47:13,833 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:47:14,230 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.2ms
2025-08-08 02:47:14,231 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:47:14,628 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  259.5ms
2025-08-08 02:47:14,629 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:47:15,020 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.5ms
2025-08-08 02:47:15,020 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:47:15,461 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.2ms
2025-08-08 02:47:15,461 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:47:15,867 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  261.2ms
2025-08-08 02:47:15,867 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:47:16,270 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  259.1ms
2025-08-08 02:47:16,270 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:47:16,647 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.6ms
2025-08-08 02:47:16,647 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:47:16,936 - app.services.supply_chain_service - ERROR - JSON Parsing Error: Expecting ',' delimiter: line 1 column 38 (char 37). Response: foo {"outer":{"inner":123,"list":[1,2,3]}} bar
2025-08-08 02:47:17,154 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 02:47:17,237 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 02:47:17,906 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-08 02:47:17,906 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 02:49:00,718 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-08 02:49:00,991 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  368.9ms
2025-08-08 02:49:00,992 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:49:01,399 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  248.5ms
2025-08-08 02:49:01,399 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:49:01,782 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  264.0ms
2025-08-08 02:49:01,782 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:49:01,895 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-08 02:49:01,896 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  113.1ms
2025-08-08 02:49:01,896 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-08 02:49:02,012 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.9ms
2025-08-08 02:49:02,013 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:49:02,090 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.9ms
2025-08-08 02:49:02,091 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:49:02,163 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.8ms
2025-08-08 02:49:02,164 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:49:02,521 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  282.3ms
2025-08-08 02:49:02,521 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:49:02,756 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  233.7ms
2025-08-08 02:49:02,756 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-08 02:49:03,115 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.5ms
2025-08-08 02:49:03,115 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:49:03,343 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 02:49:03,344 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  227.7ms
2025-08-08 02:49:03,344 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 02:49:03,457 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 02:49:03,457 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  11.7ms
2025-08-08 02:49:03,457 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 02:49:03,558 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.3ms
2025-08-08 02:49:03,558 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 02:49:03,875 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  265.9ms
2025-08-08 02:49:03,875 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:49:04,378 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 02:49:04,538 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 02:49:04,591 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-08 02:49:04,592 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-08 02:49:04,904 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-08 02:49:04,905 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-08 02:49:05,450 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 02:49:05,545 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 02:49:05,630 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 02:49:05,709 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 02:49:05,925 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose "HTTP/1.1 404 Not Found"
2025-08-08 02:49:06,020 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dosing/cancel "HTTP/1.1 404 Not Found"
2025-08-08 02:49:07,585 - app.services.dose_manager - INFO - Cancellation response for device devX: {'cancelled': True}
2025-08-08 02:49:08,940 - app.services.llm - ERROR - Malformed JSON from OpenAI: {'k':4,'l':[5,6]}
```
suffix {"m":7}
2025-08-08 02:49:09,107 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: definitely no braces
2025-08-08 02:49:10,971 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 02:49:11,369 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-08 02:49:11,379 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-08 02:49:11,816 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-08 02:49:12,251 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-08 02:49:12,253 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-08 02:49:12,456 - httpx - INFO - HTTP Request: GET https://agriculture.ec.europa.eu/cap-my-country/sustainability/environmental-sustainability/sustainable-agricultural-practices-and-methods_en "HTTP/1.1 200 OK"
2025-08-08 02:49:17,461 - app.services.serper - WARNING - Scrape failed for https://openknowledge.fao.org/handle/20.500.14283/I6787EN: The read operation timed out
2025-08-08 02:49:17,641 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 02:49:17,690 - app.services.llm - ERROR - Malformed JSON from OpenAI: {'a':1}
```
some text
```analysis
{'b':2}
2025-08-08 02:49:17,815 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.6ms
2025-08-08 02:49:17,816 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 02:49:20,071 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 02:49:20,072 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-08 02:49:20,253 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 02:49:20,253 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-08 02:49:20,608 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:49:21,610 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:49:23,612 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:49:23,795 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:49:24,796 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:49:26,798 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:49:26,980 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:49:27,982 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:49:29,984 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:49:30,218 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:49:31,220 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:49:33,221 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:49:33,381 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 02:49:34,383 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 02:49:36,385 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 02:49:36,518 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  1.2ms
2025-08-08 02:49:36,519 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 02:49:36,829 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.7ms
2025-08-08 02:49:36,829 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 02:49:37,179 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  278.2ms
2025-08-08 02:49:37,179 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:49:37,582 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.8ms
2025-08-08 02:49:37,582 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:49:37,981 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.8ms
2025-08-08 02:49:37,982 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:49:38,399 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  261.5ms
2025-08-08 02:49:38,399 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:49:38,781 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.8ms
2025-08-08 02:49:38,781 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:49:39,196 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  247.6ms
2025-08-08 02:49:39,197 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:49:39,587 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.1ms
2025-08-08 02:49:39,588 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:49:39,998 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  265.8ms
2025-08-08 02:49:39,999 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:49:40,384 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.5ms
2025-08-08 02:49:40,384 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 02:49:40,632 - app.services.supply_chain_service - ERROR - JSON Parsing Error: Expecting ',' delimiter: line 1 column 38 (char 37). Response: foo {"outer":{"inner":123,"list":[1,2,3]}} bar
2025-08-08 02:49:40,761 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 02:49:40,819 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 02:49:41,475 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-08 02:49:41,475 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 03:01:55,123 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-08 03:01:55,509 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  509.8ms
2025-08-08 03:01:55,510 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:01:56,020 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  316.1ms
2025-08-08 03:01:56,021 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:01:56,423 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  310.2ms
2025-08-08 03:01:56,424 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:01:56,436 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-08 03:01:56,436 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  11.1ms
2025-08-08 03:01:56,436 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-08 03:01:56,523 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-08 03:01:56,524 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 03:01:56,595 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.8ms
2025-08-08 03:01:56,595 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 03:01:56,669 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-08 03:01:56,670 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 03:01:57,028 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  288.6ms
2025-08-08 03:01:57,029 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:01:57,313 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  283.0ms
2025-08-08 03:01:57,314 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-08 03:01:57,694 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  291.6ms
2025-08-08 03:01:57,695 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:01:57,961 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 03:01:57,962 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  266.2ms
2025-08-08 03:01:57,963 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 03:01:58,069 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 03:01:58,069 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  11.8ms
2025-08-08 03:01:58,069 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 03:01:58,140 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.4ms
2025-08-08 03:01:58,141 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 03:01:58,501 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  288.4ms
2025-08-08 03:01:58,501 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:01:59,065 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 03:01:59,398 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 03:01:59,460 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-08 03:01:59,460 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-08 03:01:59,917 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-08 03:01:59,917 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-08 03:02:00,540 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 03:02:00,643 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 03:02:00,747 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 03:02:00,848 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 03:02:01,134 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose "HTTP/1.1 404 Not Found"
2025-08-08 03:02:01,251 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dosing/cancel "HTTP/1.1 404 Not Found"
2025-08-08 03:02:03,045 - app.services.dose_manager - INFO - Cancellation response for device devX: {'cancelled': True}
2025-08-08 03:02:04,091 - app.services.llm - ERROR - Malformed JSON from OpenAI: {'k':4,'l':[5,6]}
```
suffix {"m":7}
2025-08-08 03:02:04,240 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: definitely no braces
2025-08-08 03:02:06,189 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 03:02:06,780 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-08 03:02:06,787 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-08 03:02:06,974 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-08 03:02:06,976 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-08 03:02:07,035 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-08 03:02:07,281 - httpx - INFO - HTTP Request: GET https://ec.europa.eu/programmes/erasmus-plus/project-result-content/6585f6b6-4180-4208-9ea9-1efdb43cdf05/LIfe%20from%20Soil%20Modular%20Courses%20EN.pdf "HTTP/1.1 200 "
2025-08-08 03:02:08,084 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-08 03:02:08,086 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-08 03:03:23,422 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 03:03:23,482 - app.services.llm - ERROR - Malformed JSON from OpenAI: {'a':1}
```
some text
```analysis
{'b':2}
2025-08-08 03:03:23,630 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  1.2ms
2025-08-08 03:03:23,631 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 03:03:25,982 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 03:03:25,983 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-08 03:03:26,186 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 03:03:26,186 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-08 03:03:26,624 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 03:03:27,626 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 03:03:29,629 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 03:03:29,794 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 03:03:30,796 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 03:03:32,799 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 03:03:32,948 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 03:03:33,949 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 03:03:35,951 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 03:03:36,105 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 03:03:37,106 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 03:03:39,108 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 03:03:39,270 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 03:03:40,271 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 03:03:42,273 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 03:03:42,404 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.6ms
2025-08-08 03:03:42,404 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 03:03:42,706 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.6ms
2025-08-08 03:03:42,706 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 03:03:43,050 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  276.1ms
2025-08-08 03:03:43,051 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:03:43,422 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.4ms
2025-08-08 03:03:43,423 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:03:43,803 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.0ms
2025-08-08 03:03:43,803 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:03:44,175 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.3ms
2025-08-08 03:03:44,175 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:03:44,547 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.0ms
2025-08-08 03:03:44,548 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:03:44,941 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.1ms
2025-08-08 03:03:44,942 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:03:45,340 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.0ms
2025-08-08 03:03:45,340 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:03:45,764 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  303.0ms
2025-08-08 03:03:45,765 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:03:46,165 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  263.8ms
2025-08-08 03:03:46,165 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:03:46,449 - app.services.supply_chain_service - ERROR - JSON Parsing Error: Expecting ',' delimiter: line 1 column 38 (char 37). Response: foo {"outer":{"inner":123,"list":[1,2,3]}} bar
2025-08-08 03:03:46,603 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 03:03:46,674 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 03:03:47,490 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.7ms
2025-08-08 03:03:47,490 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 03:04:02,776 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 03:04:02,882 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 03:04:02,953 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 03:04:03,022 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 03:04:03,199 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose "HTTP/1.1 404 Not Found"
2025-08-08 03:04:03,282 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dosing/cancel "HTTP/1.1 404 Not Found"
2025-08-08 03:04:04,782 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.7ms
2025-08-08 03:04:04,782 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 03:06:36,998 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-08 03:06:36,999 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-08 03:06:37,214 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-08 03:06:37,214 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-08 03:06:37,819 - app.services.llm - ERROR - Malformed JSON from OpenAI: {'k':4,'l':[5,6]}
```
suffix {"m":7}
2025-08-08 03:06:37,960 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: definitely no braces
2025-08-08 03:06:40,008 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 03:06:40,548 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-08 03:06:40,556 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-08 03:06:40,560 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-08 03:06:40,561 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-08 03:06:40,927 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-08 03:06:41,443 - httpx - INFO - HTTP Request: GET https://www.frontiersin.org/journals/plant-science/articles/10.3389/fpls.2024.1357153/full "HTTP/1.1 200 OK"
2025-08-08 03:06:41,741 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-08 03:06:41,743 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-08 03:06:42,078 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 03:06:42,131 - app.services.llm - ERROR - Malformed JSON from OpenAI: {'a':1}
```
some text
```analysis
{'b':2}
2025-08-08 03:11:09,046 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-08 03:11:09,047 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-08 03:11:09,196 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-08 03:11:09,196 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-08 03:11:09,774 - app.services.llm - ERROR - Malformed JSON from OpenAI: {'k':4,'l':[5,6]}
```
suffix {"m":7}
2025-08-08 03:11:09,955 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: definitely no braces
2025-08-08 03:11:11,981 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 03:11:12,799 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-08 03:11:12,800 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-08 03:11:12,804 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-08 03:11:13,204 - httpx - INFO - HTTP Request: GET https://www.frontiersin.org/journals/plant-science/articles/10.3389/fpls.2024.1357153/full "HTTP/1.1 200 OK"
2025-08-08 03:11:13,385 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-08 03:11:13,387 - httpx - INFO - HTTP Request: GET https://agriculture.ec.europa.eu/system/files/2019-03/final-report-etop-greenhouse-production_0.pdf "HTTP/1.1 200 OK"
2025-08-08 03:11:13,387 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-08 03:11:14,406 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 03:11:14,491 - app.services.llm - ERROR - Malformed JSON from OpenAI: {'a':1}
```
some text
```analysis
{'b':2}
2025-08-08 03:17:56,760 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 03:17:56,872 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 03:17:56,949 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 03:17:57,023 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 03:17:57,235 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose "HTTP/1.1 404 Not Found"
2025-08-08 03:17:57,333 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dosing/cancel "HTTP/1.1 404 Not Found"
2025-08-08 03:17:58,928 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.5ms
2025-08-08 03:17:58,929 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 03:25:04,655 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 03:25:04,760 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 03:25:04,837 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 03:25:04,911 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 03:25:05,115 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose "HTTP/1.1 404 Not Found"
2025-08-08 03:25:05,210 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dosing/cancel "HTTP/1.1 404 Not Found"
2025-08-08 03:25:07,034 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  1.3ms
2025-08-08 03:25:07,035 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 03:25:23,287 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 03:25:23,410 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 03:25:23,487 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 03:25:23,552 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 03:25:23,726 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose "HTTP/1.1 404 Not Found"
2025-08-08 03:25:23,810 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dosing/cancel "HTTP/1.1 404 Not Found"
2025-08-08 03:25:25,190 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  1.0ms
2025-08-08 03:25:25,190 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 03:26:39,057 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth+Please+consider+that+the+plant+%27TestPlant%27+is+being+grown+at+%27Berlin%27.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 03:26:39,523 - httpx - INFO - HTTP Request: GET https://www.mdpi.com/2223-7747/11/5/659 "HTTP/1.1 403 Forbidden"
2025-08-08 03:26:39,525 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.mdpi.com/2223-7747/11/5/659
2025-08-08 03:26:39,632 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/259928558_The_art_of_growing_plants_for_experimental_purposes_a_practical_guide_for_the_plant_biologist "HTTP/1.1 403 Forbidden"
2025-08-08 03:26:39,642 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/259928558_The_art_of_growing_plants_for_experimental_purposes_a_practical_guide_for_the_plant_biologist
2025-08-08 03:26:39,676 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC10752760/ "HTTP/1.1 403 Forbidden"
2025-08-08 03:26:39,678 - app.services.serper - WARNING - Scrape forbidden (403) for https://pmc.ncbi.nlm.nih.gov/articles/PMC10752760/
2025-08-08 03:26:39,717 - httpx - INFO - HTTP Request: GET https://www.sciencedirect.com/science/article/pii/S0254629919300602 "HTTP/1.1 403 Forbidden"
2025-08-08 03:26:39,760 - httpx - INFO - HTTP Request: GET https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610 "HTTP/1.1 403 Forbidden"
2025-08-08 03:26:39,761 - app.services.serper - WARNING - Scrape forbidden (403) for https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610
2025-08-08 03:26:39,802 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.sciencedirect.com/science/article/pii/S0254629919300602
2025-08-08 03:26:40,017 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 03:30:06,075 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 03:30:06,151 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 03:30:06,227 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 03:30:06,314 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 03:30:06,397 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/sensor "HTTP/1.1 200 OK"
2025-08-08 03:30:06,561 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 200 OK"
2025-08-08 03:30:06,676 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 03:30:06,836 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 200 OK"
2025-08-08 03:30:06,922 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 200 OK"
2025-08-08 03:30:07,109 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 03:30:07,187 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8003/toggle "HTTP/1.1 200 OK"
2025-08-08 03:30:07,317 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8004/status "HTTP/1.1 200 OK"
2025-08-08 03:30:08,324 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  1.0ms
2025-08-08 03:30:08,325 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 03:33:07,335 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth+Please+consider+that+the+plant+%27TestPlant%27+is+being+grown+at+%27Berlin%27.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 03:33:07,595 - httpx - INFO - HTTP Request: GET https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610 "HTTP/1.1 403 Forbidden"
2025-08-08 03:33:07,598 - app.services.serper - WARNING - Scrape forbidden (403) for https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610
2025-08-08 03:33:07,688 - httpx - INFO - HTTP Request: GET https://agritech.tnau.ac.in/pdf/Plant%20Pathology_%20Concepts%20and%20Laboratory%20Exercises_240401_114653.pdf "HTTP/1.1 200 OK"
2025-08-08 03:33:07,714 - httpx - INFO - HTTP Request: GET https://www.mdpi.com/2037-0164/16/2/63 "HTTP/1.1 403 Forbidden"
2025-08-08 03:33:07,715 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.mdpi.com/2037-0164/16/2/63
2025-08-08 03:33:07,927 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/ "HTTP/1.1 403 Forbidden"
2025-08-08 03:33:07,929 - app.services.serper - WARNING - Scrape forbidden (403) for https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/
2025-08-08 03:33:07,930 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/ "HTTP/1.1 403 Forbidden"
2025-08-08 03:33:07,931 - app.services.serper - WARNING - Scrape forbidden (403) for https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/
2025-08-08 03:33:09,000 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 03:33:24,507 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 03:33:24,578 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 03:33:24,646 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 03:33:24,716 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 03:33:24,788 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/sensor "HTTP/1.1 200 OK"
2025-08-08 03:33:24,930 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 200 OK"
2025-08-08 03:33:25,029 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 03:33:25,109 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 200 OK"
2025-08-08 03:33:25,179 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 200 OK"
2025-08-08 03:33:25,376 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 03:33:25,462 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8003/toggle "HTTP/1.1 200 OK"
2025-08-08 03:33:25,598 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8004/status "HTTP/1.1 200 OK"
2025-08-08 03:33:26,701 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  1.0ms
2025-08-08 03:33:26,701 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 03:38:03,063 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 03:38:03,144 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 03:38:03,219 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 03:38:03,298 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 03:38:03,375 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/sensor "HTTP/1.1 200 OK"
2025-08-08 03:38:03,537 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 200 OK"
2025-08-08 03:38:03,650 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 03:38:03,739 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 200 OK"
2025-08-08 03:38:03,818 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 200 OK"
2025-08-08 03:38:04,027 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 03:38:04,113 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8003/toggle "HTTP/1.1 200 OK"
2025-08-08 03:38:04,254 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8004/status "HTTP/1.1 200 OK"
2025-08-08 03:38:05,231 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  1.0ms
2025-08-08 03:38:05,232 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 03:38:57,988 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth+Please+consider+that+the+plant+%27TestPlant%27+is+being+grown+at+%27Berlin%27.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 03:38:58,257 - httpx - INFO - HTTP Request: GET https://agritech.tnau.ac.in/pdf/Plant%20Pathology_%20Concepts%20and%20Laboratory%20Exercises_240401_114653.pdf "HTTP/1.1 200 OK"
2025-08-08 03:38:58,491 - httpx - INFO - HTTP Request: GET https://www.mdpi.com/2037-0164/16/2/63 "HTTP/1.1 403 Forbidden"
2025-08-08 03:38:58,492 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.mdpi.com/2037-0164/16/2/63
2025-08-08 03:38:58,543 - httpx - INFO - HTTP Request: GET https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610 "HTTP/1.1 403 Forbidden"
2025-08-08 03:38:58,545 - app.services.serper - WARNING - Scrape forbidden (403) for https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610
2025-08-08 03:38:58,568 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/ "HTTP/1.1 403 Forbidden"
2025-08-08 03:38:58,568 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/ "HTTP/1.1 403 Forbidden"
2025-08-08 03:38:58,569 - app.services.serper - WARNING - Scrape forbidden (403) for https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/
2025-08-08 03:38:58,569 - app.services.serper - WARNING - Scrape forbidden (403) for https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/
2025-08-08 03:38:59,227 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 03:39:33,777 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth+Please+consider+that+the+plant+%27TestPlant%27+is+being+grown+at+%27Berlin%27.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 03:39:34,033 - httpx - INFO - HTTP Request: GET https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610 "HTTP/1.1 403 Forbidden"
2025-08-08 03:39:34,037 - app.services.serper - WARNING - Scrape forbidden (403) for https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610
2025-08-08 03:39:34,144 - httpx - INFO - HTTP Request: GET https://www.mdpi.com/2223-7747/11/5/659 "HTTP/1.1 403 Forbidden"
2025-08-08 03:39:34,145 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.mdpi.com/2223-7747/11/5/659
2025-08-08 03:39:34,341 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/259928558_The_art_of_growing_plants_for_experimental_purposes_a_practical_guide_for_the_plant_biologist "HTTP/1.1 403 Forbidden"
2025-08-08 03:39:34,347 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/259928558_The_art_of_growing_plants_for_experimental_purposes_a_practical_guide_for_the_plant_biologist
2025-08-08 03:39:34,373 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC10752760/ "HTTP/1.1 403 Forbidden"
2025-08-08 03:39:34,374 - app.services.serper - WARNING - Scrape forbidden (403) for https://pmc.ncbi.nlm.nih.gov/articles/PMC10752760/
2025-08-08 03:39:34,424 - httpx - INFO - HTTP Request: GET https://www.sciencedirect.com/science/article/pii/S0254629919300602 "HTTP/1.1 403 Forbidden"
2025-08-08 03:39:34,501 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.sciencedirect.com/science/article/pii/S0254629919300602
2025-08-08 03:39:34,674 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 03:42:58,880 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth+Please+consider+that+the+plant+%27TestPlant%27+is+being+grown+at+%27Berlin%27.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 03:42:59,153 - httpx - INFO - HTTP Request: GET https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610 "HTTP/1.1 403 Forbidden"
2025-08-08 03:42:59,155 - app.services.serper - WARNING - Scrape forbidden (403) for https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610
2025-08-08 03:42:59,290 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/259928558_The_art_of_growing_plants_for_experimental_purposes_a_practical_guide_for_the_plant_biologist "HTTP/1.1 403 Forbidden"
2025-08-08 03:42:59,295 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/259928558_The_art_of_growing_plants_for_experimental_purposes_a_practical_guide_for_the_plant_biologist
2025-08-08 03:42:59,404 - httpx - INFO - HTTP Request: GET https://www.sciencedirect.com/science/article/pii/S0254629919300602 "HTTP/1.1 403 Forbidden"
2025-08-08 03:42:59,471 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.sciencedirect.com/science/article/pii/S0254629919300602
2025-08-08 03:42:59,480 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC10752760/ "HTTP/1.1 403 Forbidden"
2025-08-08 03:42:59,481 - app.services.serper - WARNING - Scrape forbidden (403) for https://pmc.ncbi.nlm.nih.gov/articles/PMC10752760/
2025-08-08 03:42:59,484 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC9606752/ "HTTP/1.1 403 Forbidden"
2025-08-08 03:42:59,485 - app.services.serper - WARNING - Scrape forbidden (403) for https://pmc.ncbi.nlm.nih.gov/articles/PMC9606752/
2025-08-08 03:42:59,642 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 03:45:09,542 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 03:45:09,617 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 03:45:09,688 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 03:45:09,757 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 03:45:09,827 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/sensor "HTTP/1.1 200 OK"
2025-08-08 03:45:09,969 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 200 OK"
2025-08-08 03:45:09,985 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose_monitor "HTTP/1.1 200 OK"
2025-08-08 03:45:10,052 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 03:45:10,053 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 03:45:10,054 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 03:45:10,054 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 03:45:10,055 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 03:45:10,055 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 03:45:10,157 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 200 OK"
2025-08-08 03:45:10,390 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 03:45:11,513 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  1.2ms
2025-08-08 03:45:11,514 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 03:46:22,042 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth+Please+consider+that+the+plant+%27TestPlant%27+is+being+grown+at+%27Berlin%27.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 03:46:22,293 - httpx - INFO - HTTP Request: GET https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610 "HTTP/1.1 403 Forbidden"
2025-08-08 03:46:22,294 - app.services.serper - WARNING - Scrape forbidden (403) for https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610
2025-08-08 03:46:22,513 - httpx - INFO - HTTP Request: GET https://www.mdpi.com/2037-0164/16/2/63 "HTTP/1.1 403 Forbidden"
2025-08-08 03:46:22,514 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.mdpi.com/2037-0164/16/2/63
2025-08-08 03:46:22,649 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/ "HTTP/1.1 403 Forbidden"
2025-08-08 03:46:22,650 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/ "HTTP/1.1 403 Forbidden"
2025-08-08 03:46:22,651 - app.services.serper - WARNING - Scrape forbidden (403) for https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/
2025-08-08 03:46:22,652 - app.services.serper - WARNING - Scrape forbidden (403) for https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/
2025-08-08 03:46:22,654 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/353147638_Plant_growth_the_What_the_How_and_the_Why "HTTP/1.1 403 Forbidden"
2025-08-08 03:46:22,658 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/353147638_Plant_growth_the_What_the_How_and_the_Why
2025-08-08 03:46:22,809 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 03:47:53,038 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 03:47:53,111 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 03:47:53,186 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 03:47:53,262 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 03:47:53,339 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/sensor "HTTP/1.1 200 OK"
2025-08-08 03:47:53,500 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 200 OK"
2025-08-08 03:47:53,517 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose_monitor "HTTP/1.1 200 OK"
2025-08-08 03:47:53,599 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 03:47:53,616 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 03:47:53,632 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 03:47:53,647 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 03:47:53,768 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 200 OK"
2025-08-08 03:47:53,861 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 200 OK"
2025-08-08 03:47:54,042 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 03:47:54,157 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8003/toggle "HTTP/1.1 200 OK"
2025-08-08 03:47:54,286 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8004/status "HTTP/1.1 200 OK"
2025-08-08 03:47:55,328 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  1.2ms
2025-08-08 03:47:55,329 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 03:52:01,121 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-08 03:52:01,410 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  341.8ms
2025-08-08 03:52:01,412 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:52:02,064 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  312.8ms
2025-08-08 03:52:02,064 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:52:02,491 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  315.8ms
2025-08-08 03:52:02,492 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:52:02,503 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-08 03:52:02,504 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  11.4ms
2025-08-08 03:52:02,504 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-08 03:52:02,685 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-08 03:52:02,685 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 03:52:02,770 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-08 03:52:02,770 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 03:52:02,850 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.4ms
2025-08-08 03:52:02,851 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 03:52:03,206 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  279.5ms
2025-08-08 03:52:03,206 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:52:03,444 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  238.1ms
2025-08-08 03:52:03,445 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-08 03:52:03,822 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.3ms
2025-08-08 03:52:03,822 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:52:04,055 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 03:52:04,055 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  233.0ms
2025-08-08 03:52:04,056 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 03:52:04,188 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 03:52:04,188 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  9.8ms
2025-08-08 03:52:04,189 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 03:52:04,250 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  3.4ms
2025-08-08 03:52:04,250 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 03:52:04,584 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  270.1ms
2025-08-08 03:52:04,584 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:52:05,176 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 03:52:05,288 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 03:52:05,508 - app.services.device_controller - INFO - Discovery failed for http://127.0.0.1:9999: All connection attempts failed
2025-08-08 03:52:06,008 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 03:52:06,085 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 03:52:06,156 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 03:52:06,229 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 03:52:06,306 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/sensor "HTTP/1.1 200 OK"
2025-08-08 03:52:06,512 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 200 OK"
2025-08-08 03:52:06,532 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose_monitor "HTTP/1.1 200 OK"
2025-08-08 03:52:06,612 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 03:52:06,630 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 03:52:06,645 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 03:52:06,661 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 03:52:06,742 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 200 OK"
2025-08-08 03:52:06,821 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 200 OK"
2025-08-08 03:52:07,014 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 03:52:07,099 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8003/toggle "HTTP/1.1 200 OK"
2025-08-08 03:52:07,237 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8004/status "HTTP/1.1 200 OK"
2025-08-08 03:52:11,440 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth+Please+consider+that+the+plant+%27TestPlant%27+is+being+grown+at+%27Berlin%27.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 03:52:11,729 - httpx - INFO - HTTP Request: GET https://agritech.tnau.ac.in/pdf/Plant%20Pathology_%20Concepts%20and%20Laboratory%20Exercises_240401_114653.pdf "HTTP/1.1 200 OK"
2025-08-08 03:52:12,058 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/ "HTTP/1.1 403 Forbidden"
2025-08-08 03:52:12,059 - app.services.serper - WARNING - Scrape forbidden (403) for https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/
2025-08-08 03:52:12,066 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/ "HTTP/1.1 403 Forbidden"
2025-08-08 03:52:12,067 - app.services.serper - WARNING - Scrape forbidden (403) for https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/
2025-08-08 03:52:12,114 - httpx - INFO - HTTP Request: GET https://www.mdpi.com/2037-0164/16/2/63 "HTTP/1.1 403 Forbidden"
2025-08-08 03:52:12,115 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.mdpi.com/2037-0164/16/2/63
2025-08-08 03:52:12,125 - httpx - INFO - HTTP Request: GET https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610 "HTTP/1.1 403 Forbidden"
2025-08-08 03:52:12,127 - app.services.serper - WARNING - Scrape forbidden (403) for https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610
2025-08-08 03:52:13,164 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 03:52:13,445 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  1.0ms
2025-08-08 03:52:13,446 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 03:52:16,397 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 03:52:16,398 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-08 03:52:16,621 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 03:52:16,621 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-08 03:52:17,034 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 03:52:18,035 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 03:52:20,038 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 03:52:20,231 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 03:52:21,233 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 03:52:23,234 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 03:52:23,406 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 03:52:24,408 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 03:52:26,410 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 03:52:26,591 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 03:52:27,593 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 03:52:29,596 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 03:52:29,763 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 03:52:30,765 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 03:52:32,765 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 03:52:32,868 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  1.7ms
2025-08-08 03:52:32,868 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 03:52:33,148 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.8ms
2025-08-08 03:52:33,149 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 03:52:33,489 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  281.1ms
2025-08-08 03:52:33,489 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:52:33,856 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  250.8ms
2025-08-08 03:52:33,856 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:52:34,225 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.2ms
2025-08-08 03:52:34,226 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:52:34,605 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.8ms
2025-08-08 03:52:34,605 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:52:34,988 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.4ms
2025-08-08 03:52:34,989 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:52:35,368 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.8ms
2025-08-08 03:52:35,369 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:52:35,793 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  260.8ms
2025-08-08 03:52:35,794 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:52:36,225 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  302.3ms
2025-08-08 03:52:36,225 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:52:36,637 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  269.2ms
2025-08-08 03:52:36,638 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 03:52:36,988 - app.services.supply_chain_service - ERROR - JSON Parsing Error: Expecting ',' delimiter: line 1 column 38 (char 37). Response: foo {"outer":{"inner":123,"list":[1,2,3]}} bar
2025-08-08 03:52:37,166 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 03:52:37,248 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 03:52:37,975 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.3ms
2025-08-08 03:52:37,975 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 04:13:00,447 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-08 04:13:00,713 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  332.2ms
2025-08-08 04:13:00,713 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:13:01,152 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  262.5ms
2025-08-08 04:13:01,152 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:13:01,498 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.9ms
2025-08-08 04:13:01,498 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:13:01,513 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-08 04:13:01,513 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  15.0ms
2025-08-08 04:13:01,513 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-08 04:13:01,603 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.0ms
2025-08-08 04:13:01,604 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 04:13:01,661 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-08 04:13:01,661 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 04:13:01,715 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-08 04:13:01,716 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 04:13:02,039 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  267.3ms
2025-08-08 04:13:02,039 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:13:02,270 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  229.5ms
2025-08-08 04:13:02,270 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-08 04:13:02,635 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.5ms
2025-08-08 04:13:02,635 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:13:02,869 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 04:13:02,869 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  233.0ms
2025-08-08 04:13:02,869 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 04:13:02,968 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 04:13:02,968 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  9.2ms
2025-08-08 04:13:02,968 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 04:13:03,031 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.6ms
2025-08-08 04:13:03,032 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 04:13:03,356 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  266.3ms
2025-08-08 04:13:03,357 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:13:03,963 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 04:13:04,084 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 04:13:04,359 - app.services.device_controller - INFO - Discovery failed for http://127.0.0.1:9999: All connection attempts failed
2025-08-08 04:13:04,901 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 04:13:04,986 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 04:13:05,069 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 04:13:05,153 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 04:13:05,246 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/sensor "HTTP/1.1 200 OK"
2025-08-08 04:13:05,403 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 200 OK"
2025-08-08 04:13:05,421 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose_monitor "HTTP/1.1 200 OK"
2025-08-08 04:13:05,495 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 04:13:05,512 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 04:13:05,527 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 04:13:05,542 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 04:13:05,619 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 200 OK"
2025-08-08 04:13:05,692 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 200 OK"
2025-08-08 04:13:05,875 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 04:13:05,960 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8003/toggle "HTTP/1.1 200 OK"
2025-08-08 04:13:06,097 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8004/status "HTTP/1.1 200 OK"
2025-08-08 04:13:10,519 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth+Please+consider+that+the+plant+%27TestPlant%27+is+being+grown+at+%27Berlin%27.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 04:13:11,022 - httpx - INFO - HTTP Request: GET https://www.sciencedirect.com/science/article/pii/S0254629919300602 "HTTP/1.1 403 Forbidden"
2025-08-08 04:13:11,093 - httpx - INFO - HTTP Request: GET https://www.mdpi.com/2223-7747/11/5/659 "HTTP/1.1 403 Forbidden"
2025-08-08 04:13:11,094 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.mdpi.com/2223-7747/11/5/659
2025-08-08 04:13:11,114 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/259928558_The_art_of_growing_plants_for_experimental_purposes_a_practical_guide_for_the_plant_biologist "HTTP/1.1 403 Forbidden"
2025-08-08 04:13:11,117 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC10752760/ "HTTP/1.1 403 Forbidden"
2025-08-08 04:13:11,119 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/259928558_The_art_of_growing_plants_for_experimental_purposes_a_practical_guide_for_the_plant_biologist
2025-08-08 04:13:11,119 - app.services.serper - WARNING - Scrape forbidden (403) for https://pmc.ncbi.nlm.nih.gov/articles/PMC10752760/
2025-08-08 04:13:11,120 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.sciencedirect.com/science/article/pii/S0254629919300602
2025-08-08 04:13:11,200 - httpx - INFO - HTTP Request: GET https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610 "HTTP/1.1 403 Forbidden"
2025-08-08 04:13:11,204 - app.services.serper - WARNING - Scrape forbidden (403) for https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610
2025-08-08 04:13:11,365 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 04:13:11,541 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.8ms
2025-08-08 04:13:11,542 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 04:13:13,807 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 04:13:13,808 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-08 04:13:13,974 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 04:13:13,974 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-08 04:13:14,309 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 04:13:15,310 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 04:13:17,312 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 04:13:17,472 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 04:13:18,474 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 04:13:20,476 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 04:13:20,635 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 04:13:21,636 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 04:13:23,638 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 04:13:23,793 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 04:13:24,795 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 04:13:26,805 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 04:13:26,964 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 04:13:27,966 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 04:13:29,968 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 04:13:30,082 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.3ms
2025-08-08 04:13:30,082 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 04:13:30,380 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.7ms
2025-08-08 04:13:30,380 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 04:13:30,739 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.4ms
2025-08-08 04:13:30,739 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:13:31,133 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.7ms
2025-08-08 04:13:31,133 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:13:31,514 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.8ms
2025-08-08 04:13:31,515 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:13:31,901 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.7ms
2025-08-08 04:13:31,901 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:13:32,289 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.3ms
2025-08-08 04:13:32,289 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:13:32,675 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.2ms
2025-08-08 04:13:32,675 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:13:33,069 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  261.0ms
2025-08-08 04:13:33,069 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:13:33,456 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.1ms
2025-08-08 04:13:33,457 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:13:33,848 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.7ms
2025-08-08 04:13:33,848 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:13:34,111 - app.services.supply_chain_service - ERROR - JSON Parsing Error: Expecting ',' delimiter: line 1 column 38 (char 37). Response: foo {"outer":{"inner":123,"list":[1,2,3]}} bar
2025-08-08 04:13:34,266 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 04:13:34,344 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 04:13:35,002 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.6ms
2025-08-08 04:13:35,002 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 04:21:47,931 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-08 04:21:48,195 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  317.3ms
2025-08-08 04:21:48,195 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:21:48,516 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  248.1ms
2025-08-08 04:21:48,516 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:21:48,836 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.0ms
2025-08-08 04:21:48,836 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:21:48,853 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-08 04:21:48,853 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  16.5ms
2025-08-08 04:21:48,853 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-08 04:21:48,941 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.1ms
2025-08-08 04:21:48,941 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 04:21:48,996 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-08 04:21:48,997 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 04:21:49,129 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.0ms
2025-08-08 04:21:49,130 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 04:21:49,431 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  249.2ms
2025-08-08 04:21:49,431 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:21:49,665 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  233.3ms
2025-08-08 04:21:49,665 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-08 04:21:49,998 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.3ms
2025-08-08 04:21:49,998 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:21:50,234 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 04:21:50,234 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  235.3ms
2025-08-08 04:21:50,234 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 04:21:50,331 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 04:21:50,331 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  10.3ms
2025-08-08 04:21:50,331 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 04:21:50,401 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.5ms
2025-08-08 04:21:50,402 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 04:21:50,708 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  258.9ms
2025-08-08 04:21:50,709 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:21:51,398 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 04:21:51,500 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 04:21:51,748 - app.services.device_controller - INFO - Discovery failed for http://127.0.0.1:9999: All connection attempts failed
2025-08-08 04:21:52,281 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 04:21:52,357 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 04:21:52,430 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 04:21:52,507 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 04:21:52,585 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/sensor "HTTP/1.1 200 OK"
2025-08-08 04:21:52,734 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 200 OK"
2025-08-08 04:21:52,752 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose_monitor "HTTP/1.1 200 OK"
2025-08-08 04:21:52,826 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 04:21:52,842 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 04:21:52,858 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 04:21:52,873 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 04:21:52,975 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 200 OK"
2025-08-08 04:21:53,045 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 200 OK"
2025-08-08 04:21:53,221 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 04:21:53,304 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8003/toggle "HTTP/1.1 200 OK"
2025-08-08 04:21:53,428 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8004/status "HTTP/1.1 200 OK"
2025-08-08 04:21:57,674 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth+Please+consider+that+the+plant+%27TestPlant%27+is+being+grown+at+%27Berlin%27.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 04:21:58,157 - httpx - INFO - HTTP Request: GET https://www.mdpi.com/2037-0164/16/2/63 "HTTP/1.1 403 Forbidden"
2025-08-08 04:21:58,157 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.mdpi.com/2037-0164/16/2/63
2025-08-08 04:21:58,264 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/353147638_Plant_growth_the_What_the_How_and_the_Why "HTTP/1.1 403 Forbidden"
2025-08-08 04:21:58,268 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/353147638_Plant_growth_the_What_the_How_and_the_Why
2025-08-08 04:21:58,363 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/ "HTTP/1.1 403 Forbidden"
2025-08-08 04:21:58,365 - app.services.serper - WARNING - Scrape forbidden (403) for https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/
2025-08-08 04:21:58,372 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/ "HTTP/1.1 403 Forbidden"
2025-08-08 04:21:58,373 - app.services.serper - WARNING - Scrape forbidden (403) for https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/
2025-08-08 04:21:58,408 - httpx - INFO - HTTP Request: GET https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610 "HTTP/1.1 403 Forbidden"
2025-08-08 04:21:58,413 - app.services.serper - WARNING - Scrape forbidden (403) for https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610
2025-08-08 04:21:58,577 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 04:21:58,761 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  1.1ms
2025-08-08 04:21:58,761 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 04:22:01,436 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 04:22:01,437 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-08 04:22:01,601 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 04:22:01,601 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-08 04:22:01,895 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 04:22:02,896 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 04:22:04,898 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 04:22:05,058 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 04:22:06,060 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 04:22:08,062 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 04:22:08,294 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 04:22:09,295 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 04:22:11,297 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 04:22:11,456 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 04:22:12,458 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 04:22:14,460 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 04:22:14,642 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 04:22:15,644 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 04:22:17,646 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 04:22:17,773 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.8ms
2025-08-08 04:22:17,774 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 04:22:18,093 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.8ms
2025-08-08 04:22:18,094 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 04:22:18,427 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  272.0ms
2025-08-08 04:22:18,428 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:22:18,850 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  308.5ms
2025-08-08 04:22:18,850 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:22:19,225 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  250.7ms
2025-08-08 04:22:19,225 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:22:19,600 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.7ms
2025-08-08 04:22:19,601 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:22:19,973 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  250.6ms
2025-08-08 04:22:19,973 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:22:20,322 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  243.5ms
2025-08-08 04:22:20,323 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:22:20,698 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  248.6ms
2025-08-08 04:22:20,698 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:22:21,082 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.8ms
2025-08-08 04:22:21,083 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:22:21,457 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.5ms
2025-08-08 04:22:21,458 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:22:21,681 - app.services.supply_chain_service - ERROR - JSON Parsing Error: Expecting ',' delimiter: line 1 column 38 (char 37). Response: foo {"outer":{"inner":123,"list":[1,2,3]}} bar
2025-08-08 04:22:21,803 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 04:22:21,865 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 04:22:22,461 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  1.0ms
2025-08-08 04:22:22,462 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 04:29:04,269 - uvicorn.error - INFO - Started server process [44631]
2025-08-08 04:29:04,270 - uvicorn.error - INFO - Waiting for application startup.
2025-08-08 04:29:04,270 - uvicorn.error - INFO - Application startup complete.
2025-08-08 04:29:04,272 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-08-08 04:29:10,947 - app.main - INFO - GET /docs  ip=127.0.0.1  device_id=-  307  1.7ms
2025-08-08 04:29:10,950 - app.main - INFO - GET /api/v1/docs  ip=127.0.0.1  device_id=-  200  0.2ms
2025-08-08 04:29:11,242 - app.main - INFO - GET /api/v1/openapi.json  ip=127.0.0.1  device_id=-  200  44.6ms
2025-08-08 04:41:40,403 - uvicorn.error - INFO - Shutting down
2025-08-08 04:41:40,512 - uvicorn.error - INFO - Waiting for application shutdown.
2025-08-08 04:41:40,517 - uvicorn.error - INFO - Application shutdown complete.
2025-08-08 04:41:40,518 - uvicorn.error - INFO - Finished server process [44631]
2025-08-08 04:43:48,796 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-08 04:43:49,063 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  328.5ms
2025-08-08 04:43:49,063 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:43:49,453 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.1ms
2025-08-08 04:43:49,453 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:43:49,774 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  245.5ms
2025-08-08 04:43:49,774 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:43:49,786 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-08 04:43:49,787 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  12.1ms
2025-08-08 04:43:49,787 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-08 04:43:49,875 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.9ms
2025-08-08 04:43:49,876 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 04:43:49,933 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-08 04:43:49,933 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 04:43:50,029 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.7ms
2025-08-08 04:43:50,029 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 04:43:50,336 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.3ms
2025-08-08 04:43:50,337 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:43:50,574 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  236.6ms
2025-08-08 04:43:50,574 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-08 04:43:50,920 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.0ms
2025-08-08 04:43:50,920 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:43:51,155 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 04:43:51,155 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  234.5ms
2025-08-08 04:43:51,155 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 04:43:51,253 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 04:43:51,253 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  8.9ms
2025-08-08 04:43:51,253 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 04:43:51,318 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  3.5ms
2025-08-08 04:43:51,318 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 04:43:51,647 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  266.4ms
2025-08-08 04:43:51,647 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:43:52,463 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 04:43:52,598 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 04:43:52,893 - app.services.device_controller - INFO - Discovery failed for http://127.0.0.1:9999: All connection attempts failed
2025-08-08 04:43:53,466 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 04:43:53,548 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 04:43:53,630 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 04:43:53,716 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 04:43:53,793 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/sensor "HTTP/1.1 200 OK"
2025-08-08 04:43:53,955 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 200 OK"
2025-08-08 04:43:53,973 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose_monitor "HTTP/1.1 200 OK"
2025-08-08 04:43:54,052 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 04:43:54,068 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 04:43:54,084 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 04:43:54,099 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 04:43:54,213 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 200 OK"
2025-08-08 04:43:54,293 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 200 OK"
2025-08-08 04:43:54,505 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 04:43:54,592 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8003/toggle "HTTP/1.1 200 OK"
2025-08-08 04:43:54,771 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8004/status "HTTP/1.1 200 OK"
2025-08-08 04:43:57,424 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 04:43:58,430 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 04:44:00,436 - app.services.serper - ERROR - Serper API failed after 3 attempts: [Errno 8] nodename nor servname provided, or not known
2025-08-08 04:44:00,586 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 04:44:00,760 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.6ms
2025-08-08 04:44:00,761 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 04:44:02,976 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 04:44:02,976 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-08 04:44:03,159 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 04:44:03,159 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-08 04:44:03,606 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 04:44:04,607 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 04:44:06,608 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 04:44:06,822 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 04:44:07,824 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 04:44:09,826 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 04:44:09,970 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 04:44:10,972 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 04:44:12,974 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 04:44:13,118 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 04:44:14,119 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 04:44:16,121 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 04:44:16,275 - app.services.serper - INFO - Retrying Serper API in 1.0s (attempt 1/3)
2025-08-08 04:44:17,276 - app.services.serper - INFO - Retrying Serper API in 2.0s (attempt 2/3)
2025-08-08 04:44:19,278 - app.services.serper - ERROR - Serper API failed after 3 attempts: 'R' object has no attribute 'raise_for_status'
2025-08-08 04:44:19,401 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.7ms
2025-08-08 04:44:19,402 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 04:44:19,724 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.8ms
2025-08-08 04:44:19,724 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 04:44:20,060 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  270.5ms
2025-08-08 04:44:20,060 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:44:20,438 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.8ms
2025-08-08 04:44:20,438 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:44:20,817 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.7ms
2025-08-08 04:44:20,818 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:44:21,197 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.8ms
2025-08-08 04:44:21,197 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:44:21,584 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.4ms
2025-08-08 04:44:21,585 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:44:21,987 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  258.6ms
2025-08-08 04:44:21,987 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:44:22,375 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.0ms
2025-08-08 04:44:22,376 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:44:22,769 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.3ms
2025-08-08 04:44:22,770 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:44:23,166 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.5ms
2025-08-08 04:44:23,166 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:44:23,438 - app.services.supply_chain_service - ERROR - JSON Parsing Error: Expecting ',' delimiter: line 1 column 38 (char 37). Response: foo {"outer":{"inner":123,"list":[1,2,3]}} bar
2025-08-08 04:44:23,589 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 04:44:23,645 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 04:44:24,254 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.6ms
2025-08-08 04:44:24,255 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 04:53:51,442 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=hydroponics+india&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 04:53:51,990 - httpx - INFO - HTTP Request: GET https://risehydroponics.in/ "HTTP/1.1 200 OK"
2025-08-08 04:53:52,330 - httpx - INFO - HTTP Request: GET https://www.urbankisaan.com/ "HTTP/1.1 200 OK"
2025-08-08 04:53:52,524 - httpx - INFO - HTTP Request: GET https://www.investindia.gov.in/team-india-blogs/why-hydroponics-holds-key-sustainable-agriculture "HTTP/1.1 200 OK"
2025-08-08 04:53:52,610 - httpx - INFO - HTTP Request: GET https://briohydroponics.com/ "HTTP/1.1 301 Moved Permanently"
2025-08-08 04:53:52,610 - app.services.serper - WARNING - HTTP error scraping https://briohydroponics.com/: Redirect response '301 Moved Permanently' for url 'https://briohydroponics.com/'
Redirect location: 'https://www.briohydroponics.com/'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/301
2025-08-08 04:53:53,385 - httpx - INFO - HTTP Request: GET https://enterclimate.com/blog/scope-of-hydroponic-farming-in-india/ "HTTP/1.1 200 OK"
2025-08-08 04:54:02,801 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-08 04:54:03,069 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  322.4ms
2025-08-08 04:54:03,069 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:54:03,422 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.4ms
2025-08-08 04:54:03,423 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:54:03,809 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  288.8ms
2025-08-08 04:54:03,809 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:54:03,824 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-08 04:54:03,824 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  14.4ms
2025-08-08 04:54:03,824 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-08 04:54:03,913 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.4ms
2025-08-08 04:54:03,913 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 04:54:03,973 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.4ms
2025-08-08 04:54:03,973 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 04:54:04,031 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.7ms
2025-08-08 04:54:04,031 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 04:54:04,360 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  271.9ms
2025-08-08 04:54:04,361 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:54:04,592 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  231.3ms
2025-08-08 04:54:04,593 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-08 04:54:04,950 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.7ms
2025-08-08 04:54:04,950 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:54:05,178 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 04:54:05,178 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  227.5ms
2025-08-08 04:54:05,178 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 04:54:05,281 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 04:54:05,282 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  9.9ms
2025-08-08 04:54:05,282 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 04:54:05,343 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  3.1ms
2025-08-08 04:54:05,344 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 04:54:05,666 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  264.0ms
2025-08-08 04:54:05,666 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:54:06,418 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 04:54:06,536 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 04:54:06,877 - app.services.device_controller - INFO - Discovery failed for http://127.0.0.1:9999: All connection attempts failed
2025-08-08 04:54:07,499 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 04:54:07,577 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 04:54:07,651 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 04:54:07,722 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 04:54:07,796 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/sensor "HTTP/1.1 200 OK"
2025-08-08 04:54:07,935 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 200 OK"
2025-08-08 04:54:07,953 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose_monitor "HTTP/1.1 200 OK"
2025-08-08 04:54:08,049 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 04:54:08,066 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 04:54:08,082 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 04:54:08,097 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 04:54:08,196 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 200 OK"
2025-08-08 04:54:08,263 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 200 OK"
2025-08-08 04:54:08,434 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 04:54:08,514 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8003/toggle "HTTP/1.1 200 OK"
2025-08-08 04:54:08,639 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8004/status "HTTP/1.1 200 OK"
2025-08-08 04:54:12,328 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth+Please+consider+that+the+plant+%27TestPlant%27+is+being+grown+at+%27Berlin%27.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 04:54:12,611 - httpx - INFO - HTTP Request: GET https://www.mdpi.com/2223-7747/11/5/659 "HTTP/1.1 403 Forbidden"
2025-08-08 04:54:12,611 - app.services.serper - WARNING - HTTP error scraping https://www.mdpi.com/2223-7747/11/5/659: Client error '403 Forbidden' for url 'https://www.mdpi.com/2223-7747/11/5/659'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 04:54:12,639 - httpx - INFO - HTTP Request: GET https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610 "HTTP/1.1 403 Forbidden"
2025-08-08 04:54:12,640 - app.services.serper - WARNING - HTTP error scraping https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610: Client error '403 Forbidden' for url 'https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 04:54:12,801 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/259928558_The_art_of_growing_plants_for_experimental_purposes_a_practical_guide_for_the_plant_biologist "HTTP/1.1 403 Forbidden"
2025-08-08 04:54:12,803 - app.services.serper - WARNING - HTTP error scraping https://www.researchgate.net/publication/259928558_The_art_of_growing_plants_for_experimental_purposes_a_practical_guide_for_the_plant_biologist: Client error '403 Forbidden' for url 'https://www.researchgate.net/publication/259928558_The_art_of_growing_plants_for_experimental_purposes_a_practical_guide_for_the_plant_biologist'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 04:54:13,034 - httpx - INFO - HTTP Request: GET https://www.sciencedirect.com/science/article/pii/S0254629919300602 "HTTP/1.1 403 Forbidden"
2025-08-08 04:54:13,035 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC10752760/ "HTTP/1.1 403 Forbidden"
2025-08-08 04:54:13,036 - app.services.serper - WARNING - HTTP error scraping https://pmc.ncbi.nlm.nih.gov/articles/PMC10752760/: Client error '403 Forbidden' for url 'https://pmc.ncbi.nlm.nih.gov/articles/PMC10752760/'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 04:54:13,099 - app.services.serper - WARNING - HTTP error scraping https://www.sciencedirect.com/science/article/pii/S0254629919300602: Client error '403 Forbidden' for url 'https://www.sciencedirect.com/science/article/pii/S0254629919300602'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 04:54:13,280 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 04:54:13,492 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.8ms
2025-08-08 04:54:13,493 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 04:54:15,936 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 04:54:15,937 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-08 04:54:16,165 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 04:54:16,165 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-08 04:54:17,860 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=hydroponics+india&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 04:54:18,086 - httpx - INFO - HTTP Request: GET https://www.investindia.gov.in/team-india-blogs/why-hydroponics-holds-key-sustainable-agriculture "HTTP/1.1 200 OK"
2025-08-08 04:54:18,459 - httpx - INFO - HTTP Request: GET https://risehydroponics.in/ "HTTP/1.1 200 OK"
2025-08-08 04:54:18,578 - httpx - INFO - HTTP Request: GET https://www.urbankisaan.com/ "HTTP/1.1 200 OK"
2025-08-08 04:54:18,808 - httpx - INFO - HTTP Request: GET https://briohydroponics.com/ "HTTP/1.1 301 Moved Permanently"
2025-08-08 04:54:18,808 - app.services.serper - WARNING - HTTP error scraping https://briohydroponics.com/: Redirect response '301 Moved Permanently' for url 'https://briohydroponics.com/'
Redirect location: 'https://www.briohydroponics.com/'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/301
2025-08-08 04:54:19,752 - httpx - INFO - HTTP Request: GET https://enterclimate.com/blog/scope-of-hydroponic-farming-in-india/ "HTTP/1.1 200 OK"
2025-08-08 04:54:19,979 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.5ms
2025-08-08 04:54:19,980 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 04:54:20,246 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.8ms
2025-08-08 04:54:20,246 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 04:54:20,578 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  269.6ms
2025-08-08 04:54:20,578 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:54:20,938 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  249.8ms
2025-08-08 04:54:20,938 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:54:21,306 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.4ms
2025-08-08 04:54:21,306 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:54:21,679 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.7ms
2025-08-08 04:54:21,680 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:54:22,051 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.3ms
2025-08-08 04:54:22,051 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:54:22,413 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  243.9ms
2025-08-08 04:54:22,413 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:54:22,790 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.5ms
2025-08-08 04:54:22,790 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:54:23,165 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.4ms
2025-08-08 04:54:23,165 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:54:23,540 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.5ms
2025-08-08 04:54:23,540 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 04:54:23,844 - app.services.supply_chain_service - ERROR - JSON Parsing Error: Expecting ',' delimiter: line 1 column 38 (char 37). Response: foo {"outer":{"inner":123,"list":[1,2,3]}} bar
2025-08-08 04:54:23,966 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 04:54:24,018 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 04:54:24,549 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.6ms
2025-08-08 04:54:24,549 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 04:54:44,189 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 04:54:44,189 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-08 04:54:44,240 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 04:54:44,240 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-08 04:55:19,535 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 04:55:19,536 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-08 04:55:19,719 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 04:55:19,719 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-08 05:01:04,364 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 05:01:04,365 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-08 05:01:04,514 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 05:01:04,515 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-08 05:03:32,886 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-08 05:03:33,152 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  319.8ms
2025-08-08 05:03:33,152 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:03:33,565 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  264.1ms
2025-08-08 05:03:33,566 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:03:33,896 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.0ms
2025-08-08 05:03:33,896 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:03:33,911 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-08 05:03:33,911 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  14.4ms
2025-08-08 05:03:33,911 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-08 05:03:33,994 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.4ms
2025-08-08 05:03:33,994 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 05:03:34,046 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.0ms
2025-08-08 05:03:34,046 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 05:03:34,098 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.9ms
2025-08-08 05:03:34,098 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 05:03:34,405 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  258.0ms
2025-08-08 05:03:34,405 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:03:34,640 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  234.1ms
2025-08-08 05:03:34,640 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-08 05:03:34,966 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  248.4ms
2025-08-08 05:03:34,967 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:03:35,201 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 05:03:35,201 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  233.9ms
2025-08-08 05:03:35,201 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 05:03:35,295 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 05:03:35,296 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  10.2ms
2025-08-08 05:03:35,296 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 05:03:35,354 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.4ms
2025-08-08 05:03:35,355 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 05:03:35,663 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.8ms
2025-08-08 05:03:35,663 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:03:36,360 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 05:03:36,463 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 05:03:36,713 - app.services.device_controller - INFO - Discovery failed for http://127.0.0.1:9999: All connection attempts failed
2025-08-08 05:03:37,425 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 05:03:37,498 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 05:03:37,571 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 05:03:37,640 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 05:03:37,712 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/sensor "HTTP/1.1 200 OK"
2025-08-08 05:03:37,850 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 200 OK"
2025-08-08 05:03:37,868 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose_monitor "HTTP/1.1 200 OK"
2025-08-08 05:03:37,939 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 05:03:37,956 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 05:03:37,971 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 05:03:37,987 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 05:03:38,145 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 200 OK"
2025-08-08 05:03:38,212 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 200 OK"
2025-08-08 05:03:38,379 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 05:03:38,458 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8003/toggle "HTTP/1.1 200 OK"
2025-08-08 05:03:38,579 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8004/status "HTTP/1.1 200 OK"
2025-08-08 05:03:42,185 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth+Please+consider+that+the+plant+%27TestPlant%27+is+being+grown+at+%27Berlin%27.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 05:03:42,469 - httpx - INFO - HTTP Request: GET https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610 "HTTP/1.1 403 Forbidden"
2025-08-08 05:03:42,471 - app.services.serper - WARNING - HTTP error scraping https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610: Client error '403 Forbidden' for url 'https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:03:42,554 - httpx - INFO - HTTP Request: GET https://www.mdpi.com/2037-0164/16/2/63 "HTTP/1.1 403 Forbidden"
2025-08-08 05:03:42,555 - app.services.serper - WARNING - HTTP error scraping https://www.mdpi.com/2037-0164/16/2/63: Client error '403 Forbidden' for url 'https://www.mdpi.com/2037-0164/16/2/63'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:03:42,660 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/353147638_Plant_growth_the_What_the_How_and_the_Why "HTTP/1.1 403 Forbidden"
2025-08-08 05:03:42,664 - app.services.serper - WARNING - HTTP error scraping https://www.researchgate.net/publication/353147638_Plant_growth_the_What_the_How_and_the_Why: Client error '403 Forbidden' for url 'https://www.researchgate.net/publication/353147638_Plant_growth_the_What_the_How_and_the_Why'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:03:42,778 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/ "HTTP/1.1 403 Forbidden"
2025-08-08 05:03:42,778 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/ "HTTP/1.1 403 Forbidden"
2025-08-08 05:03:42,779 - app.services.serper - WARNING - HTTP error scraping https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/: Client error '403 Forbidden' for url 'https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:03:42,779 - app.services.serper - WARNING - HTTP error scraping https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/: Client error '403 Forbidden' for url 'https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:03:42,938 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 05:03:43,117 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.7ms
2025-08-08 05:03:43,117 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 05:03:45,702 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 05:03:45,702 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-08 05:03:45,922 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 05:03:45,922 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-08 05:03:47,509 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=hydroponics+india&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 05:03:47,769 - httpx - INFO - HTTP Request: GET https://www.investindia.gov.in/team-india-blogs/why-hydroponics-holds-key-sustainable-agriculture "HTTP/1.1 200 OK"
2025-08-08 05:03:47,856 - httpx - INFO - HTTP Request: GET https://risehydroponics.in/ "HTTP/1.1 200 OK"
2025-08-08 05:03:48,637 - httpx - INFO - HTTP Request: GET https://briohydroponics.com/ "HTTP/1.1 301 Moved Permanently"
2025-08-08 05:03:48,639 - app.services.serper - WARNING - HTTP error scraping https://briohydroponics.com/: Redirect response '301 Moved Permanently' for url 'https://briohydroponics.com/'
Redirect location: 'https://www.briohydroponics.com/'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/301
2025-08-08 05:03:48,743 - httpx - INFO - HTTP Request: GET https://www.urbankisaan.com/ "HTTP/1.1 200 OK"
2025-08-08 05:03:49,455 - httpx - INFO - HTTP Request: GET https://enterclimate.com/blog/scope-of-hydroponic-farming-in-india/ "HTTP/1.1 200 OK"
2025-08-08 05:03:49,616 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-08 05:03:49,616 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 05:03:49,971 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.6ms
2025-08-08 05:03:49,971 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 05:03:50,304 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  271.6ms
2025-08-08 05:03:50,304 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:03:50,674 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.4ms
2025-08-08 05:03:50,674 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:03:51,044 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.5ms
2025-08-08 05:03:51,045 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:03:51,424 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.5ms
2025-08-08 05:03:51,424 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:03:51,803 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.4ms
2025-08-08 05:03:51,803 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:03:52,182 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.3ms
2025-08-08 05:03:52,182 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:03:52,551 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.0ms
2025-08-08 05:03:52,551 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:03:52,937 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.0ms
2025-08-08 05:03:52,937 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:03:53,310 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.8ms
2025-08-08 05:03:53,310 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:03:53,532 - app.services.supply_chain_service - ERROR - JSON Parsing Error: Expecting ',' delimiter: line 1 column 38 (char 37). Response: foo {"outer":{"inner":123,"list":[1,2,3]}} bar
2025-08-08 05:03:53,646 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 05:03:53,698 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 05:03:54,293 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.7ms
2025-08-08 05:03:54,294 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 05:12:36,494 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-08 05:12:36,762 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  320.2ms
2025-08-08 05:12:36,762 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:12:37,191 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  263.8ms
2025-08-08 05:12:37,191 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:12:37,523 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.6ms
2025-08-08 05:12:37,524 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:12:37,538 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-08 05:12:37,538 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  14.1ms
2025-08-08 05:12:37,538 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-08 05:12:37,624 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.0ms
2025-08-08 05:12:37,624 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 05:12:37,678 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-08 05:12:37,678 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 05:12:37,728 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-08 05:12:37,729 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 05:12:38,047 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  266.8ms
2025-08-08 05:12:38,047 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:12:38,278 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  230.4ms
2025-08-08 05:12:38,279 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-08 05:12:38,620 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  250.9ms
2025-08-08 05:12:38,621 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:12:38,851 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 05:12:38,851 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  229.8ms
2025-08-08 05:12:38,851 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 05:12:38,940 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 05:12:38,940 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  9.6ms
2025-08-08 05:12:38,940 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 05:12:38,999 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.3ms
2025-08-08 05:12:39,000 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 05:12:39,306 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.7ms
2025-08-08 05:12:39,306 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:12:40,011 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 05:12:40,116 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 05:12:40,357 - app.services.device_controller - INFO - Discovery failed for http://127.0.0.1:9999: All connection attempts failed
2025-08-08 05:12:40,886 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 05:12:40,968 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 05:12:41,050 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 05:12:41,128 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 05:12:41,218 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/sensor "HTTP/1.1 200 OK"
2025-08-08 05:12:41,390 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 200 OK"
2025-08-08 05:12:41,409 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose_monitor "HTTP/1.1 200 OK"
2025-08-08 05:12:41,496 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 05:12:41,514 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 05:12:41,530 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 05:12:41,545 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 05:12:41,663 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 200 OK"
2025-08-08 05:12:41,744 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 200 OK"
2025-08-08 05:12:41,970 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 05:12:42,069 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8003/toggle "HTTP/1.1 200 OK"
2025-08-08 05:12:42,243 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8004/status "HTTP/1.1 200 OK"
2025-08-08 05:12:46,548 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth+Please+consider+that+the+plant+%27TestPlant%27+is+being+grown+at+%27Berlin%27.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 05:12:46,820 - httpx - INFO - HTTP Request: GET https://www.mdpi.com/2073-4395/13/4/1134 "HTTP/1.1 403 Forbidden"
2025-08-08 05:12:46,820 - app.services.serper - WARNING - HTTP error scraping https://www.mdpi.com/2073-4395/13/4/1134: Client error '403 Forbidden' for url 'https://www.mdpi.com/2073-4395/13/4/1134'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:12:46,841 - httpx - INFO - HTTP Request: GET https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610 "HTTP/1.1 403 Forbidden"
2025-08-08 05:12:46,843 - app.services.serper - WARNING - HTTP error scraping https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610: Client error '403 Forbidden' for url 'https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:12:47,164 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/384730307_Diversity_of_organic_amendments_increases_soil_functions_and_plant_growth "HTTP/1.1 403 Forbidden"
2025-08-08 05:12:47,165 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/ "HTTP/1.1 403 Forbidden"
2025-08-08 05:12:47,165 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/ "HTTP/1.1 403 Forbidden"
2025-08-08 05:12:47,168 - app.services.serper - WARNING - HTTP error scraping https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/: Client error '403 Forbidden' for url 'https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:12:47,169 - app.services.serper - WARNING - HTTP error scraping https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/: Client error '403 Forbidden' for url 'https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:12:47,171 - app.services.serper - WARNING - HTTP error scraping https://www.researchgate.net/publication/384730307_Diversity_of_organic_amendments_increases_soil_functions_and_plant_growth: Client error '403 Forbidden' for url 'https://www.researchgate.net/publication/384730307_Diversity_of_organic_amendments_increases_soil_functions_and_plant_growth'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:12:47,339 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 05:12:47,506 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.7ms
2025-08-08 05:12:47,507 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 05:12:49,737 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 05:12:49,737 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-08 05:12:49,901 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 05:12:49,901 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-08 05:12:51,155 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=hydroponics+india&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 05:12:51,500 - httpx - INFO - HTTP Request: GET https://risehydroponics.in/ "HTTP/1.1 200 OK"
2025-08-08 05:12:52,187 - httpx - INFO - HTTP Request: GET https://www.urbankisaan.com/ "HTTP/1.1 200 OK"
2025-08-08 05:12:52,194 - httpx - INFO - HTTP Request: GET https://www.investindia.gov.in/team-india-blogs/why-hydroponics-holds-key-sustainable-agriculture "HTTP/1.1 200 OK"
2025-08-08 05:12:52,295 - httpx - INFO - HTTP Request: GET https://briohydroponics.com/ "HTTP/1.1 301 Moved Permanently"
2025-08-08 05:12:52,296 - app.services.serper - WARNING - HTTP error scraping https://briohydroponics.com/: Redirect response '301 Moved Permanently' for url 'https://briohydroponics.com/'
Redirect location: 'https://www.briohydroponics.com/'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/301
2025-08-08 05:12:52,987 - httpx - INFO - HTTP Request: GET https://enterclimate.com/blog/scope-of-hydroponic-farming-in-india/ "HTTP/1.1 200 OK"
2025-08-08 05:12:53,190 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-08 05:12:53,190 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 05:12:53,525 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  2.0ms
2025-08-08 05:12:53,526 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 05:12:53,871 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  269.3ms
2025-08-08 05:12:53,871 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:12:54,262 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.7ms
2025-08-08 05:12:54,263 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:12:54,780 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  273.5ms
2025-08-08 05:12:54,781 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:12:55,166 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.1ms
2025-08-08 05:12:55,166 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:12:55,549 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.1ms
2025-08-08 05:12:55,549 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:12:55,943 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.2ms
2025-08-08 05:12:55,943 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:12:56,389 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  306.8ms
2025-08-08 05:12:56,389 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:12:56,775 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.1ms
2025-08-08 05:12:56,775 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:12:57,161 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.8ms
2025-08-08 05:12:57,161 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:12:57,380 - app.services.supply_chain_service - ERROR - JSON Parsing Error: Expecting ',' delimiter: line 1 column 38 (char 37). Response: foo {"outer":{"inner":123,"list":[1,2,3]}} bar
2025-08-08 05:12:57,497 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 05:12:57,548 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 05:12:58,068 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.7ms
2025-08-08 05:12:58,069 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 05:20:41,065 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-08 05:20:41,359 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  358.7ms
2025-08-08 05:20:41,359 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:20:41,760 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.5ms
2025-08-08 05:20:41,760 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:20:42,096 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.9ms
2025-08-08 05:20:42,097 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:20:42,110 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-08 05:20:42,110 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  13.4ms
2025-08-08 05:20:42,111 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-08 05:20:42,195 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-08 05:20:42,195 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 05:20:42,250 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-08 05:20:42,250 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 05:20:42,303 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-08 05:20:42,304 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 05:20:42,618 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  264.1ms
2025-08-08 05:20:42,619 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:20:42,852 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  232.9ms
2025-08-08 05:20:42,852 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-08 05:20:43,181 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.7ms
2025-08-08 05:20:43,181 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:20:43,416 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 05:20:43,416 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  234.1ms
2025-08-08 05:20:43,416 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 05:20:43,530 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 05:20:43,530 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  9.9ms
2025-08-08 05:20:43,530 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 05:20:43,587 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.8ms
2025-08-08 05:20:43,587 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 05:20:43,904 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  266.2ms
2025-08-08 05:20:43,905 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:20:44,630 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 05:20:44,704 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 05:20:44,779 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 05:20:44,862 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 05:20:44,962 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/sensor "HTTP/1.1 200 OK"
2025-08-08 05:20:45,170 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 200 OK"
2025-08-08 05:20:45,190 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose_monitor "HTTP/1.1 200 OK"
2025-08-08 05:20:45,291 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 05:20:45,310 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 05:20:45,327 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 05:20:45,343 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 05:20:45,469 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 200 OK"
2025-08-08 05:20:45,558 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 200 OK"
2025-08-08 05:20:45,797 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 05:20:45,877 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8003/toggle "HTTP/1.1 200 OK"
2025-08-08 05:20:45,996 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8004/status "HTTP/1.1 200 OK"
2025-08-08 05:20:49,722 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth+Please+consider+that+the+plant+%27TestPlant%27+is+being+grown+at+%27Berlin%27.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 05:20:50,003 - httpx - INFO - HTTP Request: GET https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610 "HTTP/1.1 403 Forbidden"
2025-08-08 05:20:50,007 - app.services.serper - WARNING - HTTP error scraping https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610: Client error '403 Forbidden' for url 'https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:20:50,110 - httpx - INFO - HTTP Request: GET https://www.sciencedirect.com/science/article/pii/S0254629919300602 "HTTP/1.1 403 Forbidden"
2025-08-08 05:20:50,187 - app.services.serper - WARNING - HTTP error scraping https://www.sciencedirect.com/science/article/pii/S0254629919300602: Client error '403 Forbidden' for url 'https://www.sciencedirect.com/science/article/pii/S0254629919300602'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:20:50,205 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/259928558_The_art_of_growing_plants_for_experimental_purposes_a_practical_guide_for_the_plant_biologist "HTTP/1.1 403 Forbidden"
2025-08-08 05:20:50,214 - app.services.serper - WARNING - HTTP error scraping https://www.researchgate.net/publication/259928558_The_art_of_growing_plants_for_experimental_purposes_a_practical_guide_for_the_plant_biologist: Client error '403 Forbidden' for url 'https://www.researchgate.net/publication/259928558_The_art_of_growing_plants_for_experimental_purposes_a_practical_guide_for_the_plant_biologist'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:20:50,315 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC9606752/ "HTTP/1.1 403 Forbidden"
2025-08-08 05:20:50,316 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC10752760/ "HTTP/1.1 403 Forbidden"
2025-08-08 05:20:50,318 - app.services.serper - WARNING - HTTP error scraping https://pmc.ncbi.nlm.nih.gov/articles/PMC9606752/: Client error '403 Forbidden' for url 'https://pmc.ncbi.nlm.nih.gov/articles/PMC9606752/'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:20:50,319 - app.services.serper - WARNING - HTTP error scraping https://pmc.ncbi.nlm.nih.gov/articles/PMC10752760/: Client error '403 Forbidden' for url 'https://pmc.ncbi.nlm.nih.gov/articles/PMC10752760/'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:20:50,511 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 05:20:50,700 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  1.0ms
2025-08-08 05:20:50,700 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 05:20:53,321 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 05:20:53,321 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-08 05:20:53,480 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 05:20:53,481 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-08 05:20:54,965 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=hydroponics+india&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 05:20:55,265 - httpx - INFO - HTTP Request: GET https://www.investindia.gov.in/team-india-blogs/why-hydroponics-holds-key-sustainable-agriculture "HTTP/1.1 200 OK"
2025-08-08 05:20:55,306 - httpx - INFO - HTTP Request: GET https://risehydroponics.in/ "HTTP/1.1 200 OK"
2025-08-08 05:20:55,914 - httpx - INFO - HTTP Request: GET https://briohydroponics.com/ "HTTP/1.1 301 Moved Permanently"
2025-08-08 05:20:55,917 - app.services.serper - WARNING - HTTP error scraping https://briohydroponics.com/: Redirect response '301 Moved Permanently' for url 'https://briohydroponics.com/'
Redirect location: 'https://www.briohydroponics.com/'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/301
2025-08-08 05:20:56,400 - httpx - INFO - HTTP Request: GET https://www.urbankisaan.com/ "HTTP/1.1 200 OK"
2025-08-08 05:20:59,606 - httpx - INFO - HTTP Request: GET https://enterclimate.com/blog/scope-of-hydroponic-farming-in-india/ "HTTP/1.1 200 OK"
2025-08-08 05:20:59,744 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-08 05:20:59,744 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 05:21:00,173 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.3ms
2025-08-08 05:21:00,173 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 05:21:00,513 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  267.2ms
2025-08-08 05:21:00,513 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:21:00,914 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.4ms
2025-08-08 05:21:00,915 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:21:01,302 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.3ms
2025-08-08 05:21:01,302 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:21:01,677 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.3ms
2025-08-08 05:21:01,677 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:21:02,054 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.5ms
2025-08-08 05:21:02,055 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:21:02,467 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  293.2ms
2025-08-08 05:21:02,468 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:21:02,848 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.8ms
2025-08-08 05:21:02,848 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:21:03,213 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  248.9ms
2025-08-08 05:21:03,213 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:21:03,590 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.9ms
2025-08-08 05:21:03,591 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:21:03,811 - app.services.supply_chain_service - ERROR - JSON Parsing Error: Expecting ',' delimiter: line 1 column 38 (char 37). Response: foo {"outer":{"inner":123,"list":[1,2,3]}} bar
2025-08-08 05:21:03,924 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 05:21:04,024 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 05:21:04,559 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.7ms
2025-08-08 05:21:04,560 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-08 05:25:38,491 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-08 05:25:38,761 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  365.2ms
2025-08-08 05:25:38,761 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:25:39,177 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.0ms
2025-08-08 05:25:39,177 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:25:39,516 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.1ms
2025-08-08 05:25:39,516 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:25:39,530 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-08 05:25:39,530 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  13.6ms
2025-08-08 05:25:39,531 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-08 05:25:39,635 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.0ms
2025-08-08 05:25:39,636 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 05:25:39,693 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.0ms
2025-08-08 05:25:39,693 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 05:25:39,750 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.9ms
2025-08-08 05:25:39,750 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 05:25:40,067 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  259.8ms
2025-08-08 05:25:40,068 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:25:40,301 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  232.9ms
2025-08-08 05:25:40,302 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-08 05:25:40,684 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  304.9ms
2025-08-08 05:25:40,685 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:25:40,917 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 05:25:40,917 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  231.7ms
2025-08-08 05:25:40,917 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 05:25:41,006 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-08 05:25:41,006 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  9.7ms
2025-08-08 05:25:41,006 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-08 05:25:41,062 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.4ms
2025-08-08 05:25:41,063 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-08 05:25:41,374 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  261.8ms
2025-08-08 05:25:41,374 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:25:42,070 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/discovery "HTTP/1.1 200 OK"
2025-08-08 05:25:42,150 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/discovery "HTTP/1.1 200 OK"
2025-08-08 05:25:42,222 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/version "HTTP/1.1 200 OK"
2025-08-08 05:25:42,293 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/version "HTTP/1.1 200 OK"
2025-08-08 05:25:42,366 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8001/sensor "HTTP/1.1 200 OK"
2025-08-08 05:25:42,512 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump "HTTP/1.1 200 OK"
2025-08-08 05:25:42,530 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/dose_monitor "HTTP/1.1 200 OK"
2025-08-08 05:25:42,602 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 05:25:42,619 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 05:25:42,635 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump_calibration "HTTP/1.1 404 Not Found"
2025-08-08 05:25:42,654 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8001/pump/calibration "HTTP/1.1 404 Not Found"
2025-08-08 05:25:42,793 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8002/state "HTTP/1.1 200 OK"
2025-08-08 05:25:42,867 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8002/toggle "HTTP/1.1 200 OK"
2025-08-08 05:25:43,049 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8003/state "HTTP/1.1 200 OK"
2025-08-08 05:25:43,131 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8003/toggle "HTTP/1.1 200 OK"
2025-08-08 05:25:43,259 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8004/status "HTTP/1.1 200 OK"
2025-08-08 05:25:47,151 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth+Please+consider+that+the+plant+%27TestPlant%27+is+being+grown+at+%27Berlin%27.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 05:25:47,428 - httpx - INFO - HTTP Request: GET https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610 "HTTP/1.1 403 Forbidden"
2025-08-08 05:25:47,430 - app.services.serper - WARNING - HTTP error scraping https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610: Client error '403 Forbidden' for url 'https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.17610'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:25:47,461 - httpx - INFO - HTTP Request: GET https://www.mdpi.com/2037-0164/16/2/63 "HTTP/1.1 403 Forbidden"
2025-08-08 05:25:47,462 - app.services.serper - WARNING - HTTP error scraping https://www.mdpi.com/2037-0164/16/2/63: Client error '403 Forbidden' for url 'https://www.mdpi.com/2037-0164/16/2/63'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:25:47,640 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/353147638_Plant_growth_the_What_the_How_and_the_Why "HTTP/1.1 403 Forbidden"
2025-08-08 05:25:47,649 - app.services.serper - WARNING - HTTP error scraping https://www.researchgate.net/publication/353147638_Plant_growth_the_What_the_How_and_the_Why: Client error '403 Forbidden' for url 'https://www.researchgate.net/publication/353147638_Plant_growth_the_What_the_How_and_the_Why'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:25:47,768 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/ "HTTP/1.1 403 Forbidden"
2025-08-08 05:25:47,770 - app.services.serper - WARNING - HTTP error scraping https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/: Client error '403 Forbidden' for url 'https://pmc.ncbi.nlm.nih.gov/articles/PMC10432406/'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:25:47,788 - httpx - INFO - HTTP Request: GET https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/ "HTTP/1.1 403 Forbidden"
2025-08-08 05:25:47,790 - app.services.serper - WARNING - HTTP error scraping https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/: Client error '403 Forbidden' for url 'https://pmc.ncbi.nlm.nih.gov/articles/PMC8912713/'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403
2025-08-08 05:25:47,985 - httpx - INFO - HTTP Request: GET http://127.0.0.1:11434/api/models "HTTP/1.1 404 Not Found"
2025-08-08 05:25:50,417 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 05:25:50,417 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-08 05:25:50,585 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-08 05:25:50,585 - app.services.plant_service - INFO - No plants found, returning an empty list.
2025-08-08 05:25:51,653 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=hydroponics+india&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-08 05:25:51,919 - httpx - INFO - HTTP Request: GET https://www.investindia.gov.in/team-india-blogs/why-hydroponics-holds-key-sustainable-agriculture "HTTP/1.1 200 OK"
2025-08-08 05:25:52,142 - httpx - INFO - HTTP Request: GET https://risehydroponics.in/ "HTTP/1.1 200 OK"
2025-08-08 05:25:52,380 - httpx - INFO - HTTP Request: GET https://www.urbankisaan.com/ "HTTP/1.1 200 OK"
2025-08-08 05:25:52,578 - httpx - INFO - HTTP Request: GET https://briohydroponics.com/ "HTTP/1.1 301 Moved Permanently"
2025-08-08 05:25:52,579 - app.services.serper - WARNING - HTTP error scraping https://briohydroponics.com/: Redirect response '301 Moved Permanently' for url 'https://briohydroponics.com/'
Redirect location: 'https://www.briohydroponics.com/'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/301
2025-08-08 05:25:53,600 - httpx - INFO - HTTP Request: GET https://enterclimate.com/blog/scope-of-hydroponic-farming-in-india/ "HTTP/1.1 200 OK"
2025-08-08 05:25:53,723 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-08 05:25:53,723 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 05:25:53,988 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.6ms
2025-08-08 05:25:53,989 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-08 05:25:54,319 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  268.2ms
2025-08-08 05:25:54,319 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:25:54,690 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.9ms
2025-08-08 05:25:54,691 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:25:55,063 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  248.9ms
2025-08-08 05:25:55,063 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:25:55,443 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.9ms
2025-08-08 05:25:55,444 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:25:55,819 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.5ms
2025-08-08 05:25:55,819 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:25:56,197 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.4ms
2025-08-08 05:25:56,198 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:25:56,798 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  275.5ms
2025-08-08 05:25:56,798 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-08 05:25:57,020 - app.services.supply_chain_service - ERROR - JSON Parsing Error: Expecting ',' delimiter: line 1 column 38 (char 37). Response: foo {"outer":{"inner":123,"list":[1,2,3]}} bar
2025-08-08 05:25:57,131 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 05:25:57,179 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-08 05:25:57,703 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.7ms
2025-08-08 05:25:57,703 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
