2025-08-02 18:26:30,927 - app.main - ERROR - Error on POST /api/v1/auth/signup: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/clsregistry.py", line 516, in _resolve_name
    rval = d[token]
           ~^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_collections.py", line 345, in __missing__
    self[key] = val = self.creator(key)
                      ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/clsregistry.py", line 484, in _access_cls
    return self.fallback[key]
           ~~~~~~~~~~~~~^^^^^
KeyError: 'FarmShare'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4255, in _do_configure_registries
    mapper._post_configure_properties()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2418, in _post_configure_properties
    prop.init()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/interfaces.py", line 589, in init
    self.do_init()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 1656, in do_init
    self._setup_entity()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 1868, in _setup_entity
    self._clsregistry_resolve_name(argument)(),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/clsregistry.py", line 520, in _resolve_name
    self._raise_for_name(name, err)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/clsregistry.py", line 501, in _raise_for_name
    raise exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:30,936 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/clsregistry.py", line 516, in _resolve_name
    rval = d[token]
           ~^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_collections.py", line 345, in __missing__
    self[key] = val = self.creator(key)
                      ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/clsregistry.py", line 484, in _access_cls
    return self.fallback[key]
           ~~~~~~~~~~~~~^^^^^
KeyError: 'FarmShare'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4255, in _do_configure_registries
    mapper._post_configure_properties()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2418, in _post_configure_properties
    prop.init()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/interfaces.py", line 589, in init
    self.do_init()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 1656, in do_init
    self._setup_entity()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 1868, in _setup_entity
    self._clsregistry_resolve_name(argument)(),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/clsregistry.py", line 520, in _resolve_name
    self._raise_for_name(name, err)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/clsregistry.py", line 501, in _raise_for_name
    raise exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:31,332 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:31,333 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:31,586 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:31,587 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:31,822 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.8ms
2025-08-02 18:26:31,823 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:26:31,875 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-02 18:26:31,875 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:26:31,924 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-02 18:26:31,924 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:26:31,974 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:31,976 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:32,233 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:32,234 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:32,490 - app.main - ERROR - Error on POST /api/v1/auth/login: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 79, in login
    account = await _get_account_by_email(form_data.username, db)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:32,491 - app.main - ERROR - Unhandled exception on /api/v1/auth/login: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 79, in login
    |     account = await _get_account_by_email(form_data.username, db)
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 79, in login
    account = await _get_account_by_email(form_data.username, db)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:32,739 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.3ms
2025-08-02 18:26:32,739 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:26:32,795 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:26:32,796 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: When initializing mapper Mapper[User(users)], expression 'FarmShare' failed to locate a name ('FarmShare'). If this is a class name, consider adding this relationship() to the <class 'app.models.User'> class after both dependent classes have been defined.
2025-08-02 18:32:04,763 - app.main - ERROR - Error on POST /api/v1/auth/signup: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2522, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'farm_shares'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4255, in _do_configure_registries
    mapper._post_configure_properties()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2418, in _post_configure_properties
    prop.init()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/interfaces.py", line 589, in init
    self.do_init()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 1661, in do_init
    self._generate_backref()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 2147, in _generate_backref
    self._add_reverse_property(self.back_populates)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 1592, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2524, in get_property
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:04,772 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2522, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'farm_shares'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4255, in _do_configure_registries
    mapper._post_configure_properties()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2418, in _post_configure_properties
    prop.init()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/interfaces.py", line 589, in init
    self.do_init()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 1661, in do_init
    self._generate_backref()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 2147, in _generate_backref
    self._add_reverse_property(self.back_populates)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/relationships.py", line 1592, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2524, in get_property
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:05,157 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:05,158 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:05,459 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:05,460 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:05,700 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.8ms
2025-08-02 18:32:05,700 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:32:05,753 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.1ms
2025-08-02 18:32:05,754 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:32:05,806 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.0ms
2025-08-02 18:32:05,807 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:32:05,856 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:05,857 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:06,110 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:06,111 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:06,370 - app.main - ERROR - Error on POST /api/v1/auth/login: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 79, in login
    account = await _get_account_by_email(form_data.username, db)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:06,371 - app.main - ERROR - Unhandled exception on /api/v1/auth/login: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 79, in login
    |     account = await _get_account_by_email(form_data.username, db)
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 79, in login
    account = await _get_account_by_email(form_data.username, db)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:06,614 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.3ms
2025-08-02 18:32:06,614 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:32:06,669 - app.main - ERROR - Error on POST /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:32:06,670 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    |     existing = await _get_account_by_email(user_create.email, db)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    |     noload(User.farms),
    |     ^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    |     return _generate_from_keys(Load.noload, keys, False, {})
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    |     lead_element = Load(lead_entity)
    |                    ^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    |     insp._post_inspect
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    |     obj.__dict__[self.__name__] = result = self.fget(obj)
    |                                            ^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    |     self._check_configure()
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    |     _configure_registries({self.registry}, cascade=True)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    |     _do_configure_registries(registries, cascade)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    |     raise e
    | sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 110, in signup
    existing = await _get_account_by_email(user_create.email, db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 48, in _get_account_by_email
    noload(User.farms),
    ^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2450, in noload
    return _generate_from_keys(Load.noload, keys, False, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 2327, in _generate_from_keys
    lead_element = Load(lead_entity)
                   ^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/strategy_options.py", line 1012, in __init__
    insp._post_inspect
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[FarmShare(farm_shares)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'farm_shares'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-08-02 18:36:03,316 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 18:36:03,582 - app.main - ERROR - Error on POST /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:03,596 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:04,294 - app.main - ERROR - Error on POST /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:04,296 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:04,892 - app.main - ERROR - Error on POST /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:04,893 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:05,246 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.8ms
2025-08-02 18:36:05,246 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:36:05,299 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-02 18:36:05,299 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:36:05,347 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.1ms
2025-08-02 18:36:05,348 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:36:05,658 - app.main - ERROR - Error on POST /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:05,659 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:06,259 - app.main - ERROR - Error on POST /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:06,261 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:06,687 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:36:06,687 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  64.3ms
2025-08-02 18:36:06,687 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:36:06,740 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  1.8ms
2025-08-02 18:36:06,740 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:36:07,037 - app.main - ERROR - Error on POST /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:36:07,038 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/routers/auth.py", line 141, in signup
    await db.refresh(user)  # will pull back the generated ID, etc.
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 331, in refresh
    await greenlet_spawn(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3168, in refresh
    loading.load_on_ident(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 509, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column farms_1.latitude does not exist
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.latitude, farms_1.longitude, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.id = $1::INTEGER]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-02 18:38:44,086 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 18:38:44,360 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  317.0ms
2025-08-02 18:38:44,360 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:38:44,749 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  258.3ms
2025-08-02 18:38:44,750 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:38:45,072 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.4ms
2025-08-02 18:38:45,075 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:38:45,186 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-02 18:38:45,186 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  108.6ms
2025-08-02 18:38:45,186 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-02 18:38:45,271 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.8ms
2025-08-02 18:38:45,272 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:38:45,324 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-02 18:38:45,324 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:38:45,373 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.1ms
2025-08-02 18:38:45,373 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:38:45,682 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  258.7ms
2025-08-02 18:38:45,682 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:38:45,913 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  230.5ms
2025-08-02 18:38:45,913 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-02 18:38:46,240 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  249.7ms
2025-08-02 18:38:46,240 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:38:46,472 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:38:46,473 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  231.7ms
2025-08-02 18:38:46,473 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:38:46,556 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:38:46,557 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  9.8ms
2025-08-02 18:38:46,557 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:38:46,612 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.2ms
2025-08-02 18:38:46,612 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:38:46,921 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  260.1ms
2025-08-02 18:38:46,921 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:40:33,799 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 18:40:34,058 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  301.2ms
2025-08-02 18:40:34,058 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:40:34,465 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  264.2ms
2025-08-02 18:40:34,465 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:40:34,808 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.6ms
2025-08-02 18:40:34,808 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:40:34,821 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-02 18:40:34,822 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  12.7ms
2025-08-02 18:40:34,822 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-02 18:40:34,899 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.9ms
2025-08-02 18:40:34,900 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:34,953 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-02 18:40:34,954 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:35,004 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-02 18:40:35,004 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:35,352 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  268.4ms
2025-08-02 18:40:35,353 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:40:35,583 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  230.3ms
2025-08-02 18:40:35,584 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-02 18:40:35,926 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.3ms
2025-08-02 18:40:35,927 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:40:36,160 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:40:36,161 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  233.4ms
2025-08-02 18:40:36,161 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:40:36,313 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:40:36,313 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  68.9ms
2025-08-02 18:40:36,313 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:40:36,367 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.0ms
2025-08-02 18:40:36,367 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:36,671 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.8ms
2025-08-02 18:40:36,672 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:40:37,168 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-02 18:40:37,220 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 18:40:37,220 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 18:40:37,534 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-02 18:40:37,534 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-02 18:40:38,832 - app.services.dose_manager - INFO - Cancellation response for device devX: {'cancelled': True}
2025-08-02 18:40:39,742 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: no braces at all
2025-08-02 18:40:41,668 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-02 18:40:42,012 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-02 18:40:42,017 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-02 18:40:42,040 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-02 18:40:42,042 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-02 18:40:42,296 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-02 18:40:42,841 - httpx - INFO - HTTP Request: GET https://www.frontiersin.org/journals/plant-science/articles/10.3389/fpls.2024.1357153/full "HTTP/1.1 200 OK"
2025-08-02 18:40:43,006 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-02 18:40:43,008 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-02 18:40:43,887 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-08-02 18:40:43,888 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 18:40:43,888 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 18:40:44,353 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-02 18:40:44,353 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-02 18:40:44,499 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.6ms
2025-08-02 18:40:44,499 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:44,557 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.7ms
2025-08-02 18:40:44,558 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:44,618 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.5ms
2025-08-02 18:40:44,619 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:44,675 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-02 18:40:44,676 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:44,771 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.9ms
2025-08-02 18:40:44,771 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:44,825 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.9ms
2025-08-02 18:40:44,826 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:40:45,090 - app.main - WARNING - HTTPException Could not validate credentials on /api/v1/devices/dosing
2025-08-02 18:40:45,091 - app.main - INFO - POST /api/v1/devices/dosing  ip=127.0.0.1  device_id=-  401  1.5ms
2025-08-02 18:40:45,091 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/devices/dosing "HTTP/1.1 401 Unauthorized"
2025-08-02 18:40:45,147 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-02 18:40:45,147 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-02 18:43:48,288 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 18:43:48,555 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  308.5ms
2025-08-02 18:43:48,556 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:43:48,946 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  264.3ms
2025-08-02 18:43:48,947 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:43:49,283 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.8ms
2025-08-02 18:43:49,283 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:43:49,301 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-02 18:43:49,301 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  17.1ms
2025-08-02 18:43:49,301 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-02 18:43:49,379 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.8ms
2025-08-02 18:43:49,379 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:43:49,432 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-02 18:43:49,432 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:43:49,480 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.2ms
2025-08-02 18:43:49,481 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:43:49,791 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  264.3ms
2025-08-02 18:43:49,791 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:43:50,023 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  231.3ms
2025-08-02 18:43:50,023 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-02 18:43:50,357 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.5ms
2025-08-02 18:43:50,357 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:43:50,590 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:43:50,590 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  232.0ms
2025-08-02 18:43:50,590 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:43:50,676 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:43:50,676 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  10.3ms
2025-08-02 18:43:50,677 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:43:50,735 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.6ms
2025-08-02 18:43:50,735 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:43:51,042 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  260.7ms
2025-08-02 18:43:51,043 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:51:08,815 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 18:51:09,083 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  313.8ms
2025-08-02 18:51:09,084 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:51:09,501 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  265.3ms
2025-08-02 18:51:09,501 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:51:09,833 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.6ms
2025-08-02 18:51:09,833 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:51:09,850 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-02 18:51:09,850 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  16.4ms
2025-08-02 18:51:09,851 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-02 18:51:09,993 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.8ms
2025-08-02 18:51:09,993 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:51:10,046 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.0ms
2025-08-02 18:51:10,046 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:51:10,093 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  0.9ms
2025-08-02 18:51:10,093 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:51:10,400 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  261.7ms
2025-08-02 18:51:10,401 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:51:10,633 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  231.8ms
2025-08-02 18:51:10,633 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-02 18:51:10,965 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.2ms
2025-08-02 18:51:10,965 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:51:11,199 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:51:11,199 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  233.2ms
2025-08-02 18:51:11,199 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:51:11,285 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:51:11,285 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  10.0ms
2025-08-02 18:51:11,285 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:51:11,340 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.3ms
2025-08-02 18:51:11,340 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:51:11,656 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  267.0ms
2025-08-02 18:51:11,656 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:44,929 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 18:56:45,193 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  367.4ms
2025-08-02 18:56:45,194 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:45,641 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  246.2ms
2025-08-02 18:56:45,642 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:45,953 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  247.2ms
2025-08-02 18:56:45,953 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:45,972 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-02 18:56:45,972 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  18.0ms
2025-08-02 18:56:45,972 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-02 18:56:46,046 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-02 18:56:46,047 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:56:46,098 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.1ms
2025-08-02 18:56:46,098 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:56:46,162 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  10.9ms
2025-08-02 18:56:46,169 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:56:46,493 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  250.2ms
2025-08-02 18:56:46,493 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:46,729 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  234.9ms
2025-08-02 18:56:46,729 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-02 18:56:47,074 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.6ms
2025-08-02 18:56:47,074 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:47,305 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:56:47,305 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  230.8ms
2025-08-02 18:56:47,305 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:56:47,388 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 18:56:47,388 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  9.1ms
2025-08-02 18:56:47,388 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 18:56:47,441 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.2ms
2025-08-02 18:56:47,441 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 18:56:47,743 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  254.1ms
2025-08-02 18:56:47,743 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:48,208 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-02 18:56:48,256 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 18:56:48,256 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 18:56:48,510 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-02 18:56:48,510 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-02 18:56:49,560 - app.services.dose_manager - INFO - Cancellation response for device devX: {'cancelled': True}
2025-08-02 18:56:50,321 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: no braces at all
2025-08-02 18:56:52,078 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-02 18:56:52,366 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-02 18:56:52,368 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-02 18:56:52,385 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-02 18:56:52,387 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-02 18:56:52,612 - httpx - INFO - HTTP Request: GET https://www.sciencedirect.com/science/article/pii/S0301479724014737 "HTTP/1.1 403 Forbidden"
2025-08-02 18:56:52,715 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.sciencedirect.com/science/article/pii/S0301479724014737
2025-08-02 18:56:52,732 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-02 18:56:53,385 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-02 18:56:53,386 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-02 18:56:53,538 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-08-02 18:56:53,538 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 18:56:53,538 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 18:56:53,609 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.3ms
2025-08-02 18:56:53,609 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 18:56:54,358 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-02 18:56:54,358 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-02 18:56:54,564 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-02 18:56:54,565 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 18:56:54,938 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  283.9ms
2025-08-02 18:56:54,939 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:55,332 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.7ms
2025-08-02 18:56:55,333 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:55,738 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  259.0ms
2025-08-02 18:56:55,739 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:56,234 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  272.0ms
2025-08-02 18:56:56,234 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:56,627 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.0ms
2025-08-02 18:56:56,628 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:57,062 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  287.6ms
2025-08-02 18:56:57,062 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:57,467 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  257.7ms
2025-08-02 18:56:57,467 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:57,877 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  258.5ms
2025-08-02 18:56:57,878 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:58,263 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  252.4ms
2025-08-02 18:56:58,263 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 18:56:58,645 - app.main - ERROR - Error on POST /api/v1/devices/dosing: name 'JWTError' is not defined
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    except JWTError:
           ^^^^^^^^
NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
2025-08-02 18:56:58,655 - app.main - ERROR - Unhandled exception on /api/v1/devices/dosing: name 'JWTError' is not defined
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    |     solved_result = await solve_dependencies(
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    |     solved = await call(**solved_result.values)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    |     except JWTError:
    |            ^^^^^^^^
    | NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    except JWTError:
           ^^^^^^^^
NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
2025-08-02 18:56:58,840 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.2ms
2025-08-02 18:56:58,840 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-02 19:00:52,951 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 19:00:53,224 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  322.7ms
2025-08-02 19:00:53,225 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:00:53,899 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  405.4ms
2025-08-02 19:00:53,900 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:00:54,264 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  267.3ms
2025-08-02 19:00:54,264 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:00:54,280 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-02 19:00:54,281 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  15.6ms
2025-08-02 19:00:54,281 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-02 19:00:54,379 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.4ms
2025-08-02 19:00:54,379 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:00:54,465 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.4ms
2025-08-02 19:00:54,466 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:00:54,533 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  2.0ms
2025-08-02 19:00:54,533 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:00:54,869 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  271.5ms
2025-08-02 19:00:54,869 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:00:55,102 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  232.3ms
2025-08-02 19:00:55,102 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-02 19:00:55,462 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  256.1ms
2025-08-02 19:00:55,462 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:00:55,694 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 19:00:55,694 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  231.7ms
2025-08-02 19:00:55,694 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 19:00:55,850 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 19:00:55,850 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  12.7ms
2025-08-02 19:00:55,850 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 19:00:55,917 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  3.8ms
2025-08-02 19:00:55,917 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:00:56,229 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.4ms
2025-08-02 19:00:56,229 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:00:56,746 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-02 19:00:56,808 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 19:00:56,808 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 19:00:57,162 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-02 19:00:57,162 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-02 19:00:58,263 - app.services.dose_manager - INFO - Cancellation response for device devX: {'cancelled': True}
2025-08-02 19:00:59,047 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: no braces at all
2025-08-02 19:01:00,830 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-02 19:01:01,198 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-02 19:01:01,207 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-02 19:01:01,207 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-02 19:01:01,212 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-02 19:01:01,562 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-02 19:01:02,374 - httpx - INFO - HTTP Request: GET https://www.frontiersin.org/journals/plant-science/articles/10.3389/fpls.2024.1357153/full "HTTP/1.1 200 OK"
2025-08-02 19:01:02,479 - httpx - INFO - HTTP Request: GET https://cordis.europa.eu/project/id/613781/reporting "HTTP/1.1 200 OK"
2025-08-02 19:01:04,730 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-08-02 19:01:04,734 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 19:01:04,734 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 19:01:04,809 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.6ms
2025-08-02 19:01:04,810 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:01:05,376 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-02 19:01:05,377 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-02 19:01:05,556 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-02 19:01:05,557 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:01:05,862 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.8ms
2025-08-02 19:01:05,863 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:01:06,222 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  283.6ms
2025-08-02 19:01:06,222 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:06,600 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  250.2ms
2025-08-02 19:01:06,601 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:06,984 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.1ms
2025-08-02 19:01:06,985 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:07,377 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  250.6ms
2025-08-02 19:01:07,377 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:07,710 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  240.1ms
2025-08-02 19:01:07,711 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:08,110 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  270.5ms
2025-08-02 19:01:08,111 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:08,485 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  236.6ms
2025-08-02 19:01:08,486 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:08,814 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  235.4ms
2025-08-02 19:01:08,814 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:09,187 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  250.1ms
2025-08-02 19:01:09,187 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:01:09,535 - app.main - ERROR - Error on POST /api/v1/devices/dosing: name 'JWTError' is not defined
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    except JWTError:
           ^^^^^^^^
NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
2025-08-02 19:01:09,544 - app.main - ERROR - Unhandled exception on /api/v1/devices/dosing: name 'JWTError' is not defined
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    |     solved_result = await solve_dependencies(
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    |     solved = await call(**solved_result.values)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    |     except JWTError:
    |            ^^^^^^^^
    | NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    except JWTError:
           ^^^^^^^^
NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
2025-08-02 19:01:09,724 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.2ms
2025-08-02 19:01:09,725 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
2025-08-02 19:13:31,041 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-08-02 19:13:31,359 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  360.4ms
2025-08-02 19:13:31,360 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:31,908 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  266.5ms
2025-08-02 19:13:31,908 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:32,274 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  264.6ms
2025-08-02 19:13:32,274 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:32,287 - app.main - WARNING - HTTPException Email already registered on /api/v1/auth/signup
2025-08-02 19:13:32,287 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  400  13.0ms
2025-08-02 19:13:32,288 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 400 Bad Request"
2025-08-02 19:13:32,406 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.9ms
2025-08-02 19:13:32,407 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:13:32,588 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  1.3ms
2025-08-02 19:13:32,588 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:13:32,674 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  422  2.0ms
2025-08-02 19:13:32,675 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:13:33,010 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  272.3ms
2025-08-02 19:13:33,010 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:33,239 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  200  228.1ms
2025-08-02 19:13:33,239 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
2025-08-02 19:13:33,603 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  259.5ms
2025-08-02 19:13:33,603 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:33,841 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 19:13:33,841 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  237.4ms
2025-08-02 19:13:33,842 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 19:13:33,971 - app.main - WARNING - HTTPException Invalid credentials on /api/v1/auth/login
2025-08-02 19:13:33,971 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  401  10.2ms
2025-08-02 19:13:33,972 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
2025-08-02 19:13:34,047 - app.main - INFO - POST /api/v1/auth/login  ip=127.0.0.1  device_id=-  422  2.7ms
2025-08-02 19:13:34,048 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-08-02 19:13:34,373 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  263.2ms
2025-08-02 19:13:34,373 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:34,972 - app.services.supply_chain_service - ERROR - No valid JSON block found in LLM response.
2025-08-02 19:13:35,028 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 19:13:35,028 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 19:13:35,328 - app.services.llm - INFO - Sending prompt to LLM:

2025-08-02 19:13:35,328 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:

2025-08-02 19:13:36,552 - app.services.dose_manager - INFO - Cancellation response for device devX: {'cancelled': True}
2025-08-02 19:13:37,321 - app.services.llm - ERROR - No valid JSON block found in OpenAI response: no braces at all
2025-08-02 19:13:40,058 - httpx - INFO - HTTP Request: GET https://google.serper.dev/search?q=optimal+growth.+Focus+on+best+practices+in+Europe+for+Veggie+cultivation.&gl=in&hl=en&apiKey=eeaeee2729768c737ca5a6004968a9840677e523&num=5&full=true&output=detailed "HTTP/1.1 200 OK"
2025-08-02 19:13:40,381 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas "HTTP/1.1 403 Forbidden"
2025-08-02 19:13:40,395 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/260984593_Good_Agricultural_Practices_for_greenhouse_vegetable_crops_Principles_for_Mediterranean_climate_areas
2025-08-02 19:13:40,418 - httpx - INFO - HTTP Request: GET https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe "HTTP/1.1 403 Forbidden"
2025-08-02 19:13:40,418 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.researchgate.net/publication/323363546_Strategies_for_optimal_fertiliser_management_of_vegetable_crops_in_Europe
2025-08-02 19:13:40,707 - httpx - INFO - HTTP Request: GET https://www.sciencedirect.com/science/article/pii/S0301479724014737 "HTTP/1.1 403 Forbidden"
2025-08-02 19:13:40,733 - httpx - INFO - HTTP Request: GET https://www.fao.org/4/i3284e/i3284e.pdf "HTTP/1.1 200 OK"
2025-08-02 19:13:40,842 - app.services.serper - WARNING - Scrape forbidden (403) for https://www.sciencedirect.com/science/article/pii/S0301479724014737
2025-08-02 19:13:41,374 - httpx - INFO - HTTP Request: GET https://www.agronomyjournals.com/article/view/2394/8-1-44 "HTTP/1.1 302 Moved Temporarily"
2025-08-02 19:13:41,375 - app.services.serper - WARNING - HTTP error scraping https://www.agronomyjournals.com/article/view/2394/8-1-44: Redirect response '302 Moved Temporarily' for url 'https://www.agronomyjournals.com/article/view/2394/8-1-44'
Redirect location: 'https://www.agronomyjournals.com/archives/2025/vol8issue1/PartD/8-1-44-621.pdf'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302
2025-08-02 19:13:41,710 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-08-02 19:13:41,710 - app.services.llm - INFO - Sending prompt to LLM:
Return exactly this JSON: {"foo":42}
2025-08-02 19:13:41,710 - app.services.llm - INFO - Ollama  deepseek-r1:1.5b prompt:
Return exactly this JSON: {"foo":42}
2025-08-02 19:13:41,766 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.5ms
2025-08-02 19:13:41,766 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:13:42,286 - app.services.plant_service - INFO - Fetching plants from database...
2025-08-02 19:13:42,286 - app.services.plant_service - INFO - Fetched 1 plants from the database
2025-08-02 19:13:42,488 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.3ms
2025-08-02 19:13:42,488 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:13:42,756 - app.main - INFO - POST /admin/plans/  ip=127.0.0.1  device_id=-  404  0.4ms
2025-08-02 19:13:42,756 - httpx - INFO - HTTP Request: POST http://testserver/admin/plans/ "HTTP/1.1 404 Not Found"
2025-08-02 19:13:43,118 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  298.5ms
2025-08-02 19:13:43,118 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:43,485 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.2ms
2025-08-02 19:13:43,486 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:43,856 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.8ms
2025-08-02 19:13:43,856 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:44,208 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  248.3ms
2025-08-02 19:13:44,208 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:44,561 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  248.4ms
2025-08-02 19:13:44,562 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:44,934 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.6ms
2025-08-02 19:13:44,934 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:45,307 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  251.8ms
2025-08-02 19:13:45,307 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:45,681 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  253.5ms
2025-08-02 19:13:45,682 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:46,059 - app.main - INFO - POST /api/v1/auth/signup  ip=127.0.0.1  device_id=-  201  255.5ms
2025-08-02 19:13:46,059 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 201 Created"
2025-08-02 19:13:46,389 - app.main - ERROR - Error on POST /api/v1/devices/dosing: name 'JWTError' is not defined
Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    except JWTError:
           ^^^^^^^^
NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
2025-08-02 19:13:46,397 - app.main - ERROR - Unhandled exception on /api/v1/devices/dosing: name 'JWTError' is not defined
  + Exception Group Traceback (most recent call last):
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ^^^^^^^^^^^^^^^^^^^^
    |   File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    |     raise app_exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    |     solved_result = await solve_dependencies(
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    |     solved = await call(**solved_result.values)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    |     except JWTError:
    |            ^^^^^^^^
    | NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/env/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/saswatpandey/hydroleaf/app/dependencies.py", line 46, in get_current_user
    except JWTError:
           ^^^^^^^^
NameError: name 'JWTError' is not defined. Did you mean: 'EOFError'?
2025-08-02 19:13:46,569 - app.main - INFO - POST /admin/device/nonexistent/issue-token  ip=127.0.0.1  device_id=-  404  0.2ms
2025-08-02 19:13:46,570 - httpx - INFO - HTTP Request: POST http://testserver/admin/device/nonexistent/issue-token "HTTP/1.1 404 Not Found"
