2025-07-31 21:55:41,632 - app.main - ERROR - Error on POST /api/v1/auth/signup: Task <Task pending name='starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro' coro=<BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro() running at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py:140> cb=[TaskGroup._spawn.<locals>.task_done() at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\anyio\_backends\_asyncio.py:794]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    resp = await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    raise app_exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 46, in signup
    existing = await db.execute(
               ^^^^^^^^^^^^^^^^^
        select(User).where(User.email == user_create.email)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise exc_info[1].with_traceback(exc_info[2])
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 794, in _handle_exception
    raise error
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    await self._transaction.start()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    await self._connection.execute(query)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 375, in query
RuntimeError: Task <Task pending name='starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro' coro=<BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro() running at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py:140> cb=[TaskGroup._spawn.<locals>.task_done() at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\anyio\_backends\_asyncio.py:794]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-07-31 21:55:41,647 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: Task <Task pending name='starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro' coro=<BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro() running at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py:140> cb=[TaskGroup._spawn.<locals>.task_done() at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\anyio\_backends\_asyncio.py:794]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\anyio\_backends\_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\useit\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    |     resp = await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    |     raise app_exc
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 46, in signup
    |     existing = await db.execute(
    |                ^^^^^^^^^^^^^^^^^
    |         select(User).where(User.email == user_create.email)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    |     result = await greenlet_spawn(
    |              ^^^^^^^^^^^^^^^^^^^^^
    |     ...<6 lines>...
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    |     result = context.throw(*sys.exc_info())
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    |     result: Result[Any] = compile_state_cls.orm_execute_statement(
    |                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self,
    |         ^^^^^
    |     ...<4 lines>...
    |         conn,
    |         ^^^^^
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    |     result = conn.execute(
    |         statement, params or {}, execution_options=execution_options
    |     )
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    |     return meth(
    |         self,
    |         distilled_parameters,
    |         execution_options or NO_OPTIONS,
    |     )
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    |     return connection._execute_clauseelement(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self, distilled_params, execution_options
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    |     ret = self._execute_context(
    |         dialect,
    |     ...<8 lines>...
    |         cache_hit=cache_hit,
    |     )
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    |     return self._exec_single_context(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         dialect, context, statement, parameters
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    |     self._handle_dbapi_exception(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         e, str_statement, effective_parameters, cursor, context
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    |     raise exc_info[1].with_traceback(exc_info[2])
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    |     self.dialect.do_execute(
    |     ~~~~~~~~~~~~~~~~~~~~~~~^
    |         cursor, str_statement, effective_parameters, context
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    |     cursor.execute(statement, parameters)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    |     self._adapt_connection.await_(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self._prepare_and_execute(operation, parameters)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
    |            ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    |     value = await result
    |             ^^^^^^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    |     await adapt_connection._start_transaction()
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    |     self._handle_exception(error)
    |     ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 794, in _handle_exception
    |     raise error
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    |     await self._transaction.start()
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    |     await self._connection.execute(query)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    |     result = await self._protocol.query(query, timeout)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "asyncpg\\protocol\\protocol.pyx", line 375, in query
    | RuntimeError: Task <Task pending name='starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro' coro=<BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro() running at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py:140> cb=[TaskGroup._spawn.<locals>.task_done() at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\anyio\_backends\_asyncio.py:794]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\useit\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    resp = await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    raise app_exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 46, in signup
    existing = await db.execute(
               ^^^^^^^^^^^^^^^^^
        select(User).where(User.email == user_create.email)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise exc_info[1].with_traceback(exc_info[2])
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 794, in _handle_exception
    raise error
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    await self._transaction.start()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    await self._connection.execute(query)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 375, in query
RuntimeError: Task <Task pending name='starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro' coro=<BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro() running at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py:140> cb=[TaskGroup._spawn.<locals>.task_done() at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\anyio\_backends\_asyncio.py:794]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-07-31 21:55:42,781 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 422 • 2.4ms
2025-07-31 21:55:42,782 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-07-31 21:55:43,157 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 422 • 2.2ms
2025-07-31 21:55:43,158 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-07-31 21:55:43,503 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 422 • 2.6ms
2025-07-31 21:55:43,504 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-07-31 21:55:43,811 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 422 • 1.6ms
2025-07-31 21:55:43,812 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-07-31 21:55:44,142 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 422 • 1.3ms
2025-07-31 21:55:44,143 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-07-31 21:55:44,486 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 422 • 2.1ms
2025-07-31 21:55:44,487 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-07-31 21:55:44,899 - app.main - ERROR - Error on POST /api/v1/auth/login: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('nouser@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    await self._transaction.start()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    await self._connection.execute(query)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 360, in query
  File "asyncpg\\protocol\\protocol.pyx", line 745, in asyncpg.protocol.protocol.BaseProtocol._check_state
asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    resp = await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    raise app_exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 85, in login
    result = await db.execute(
             ^^^^^^^^^^^^^^^^^
        select(User).where(User.email == form_data.username)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('nouser@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-07-31 21:55:44,909 - app.main - ERROR - Unhandled exception on /api/v1/auth/login: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('nouser@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    await self._transaction.start()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    await self._connection.execute(query)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 360, in query
  File "asyncpg\\protocol\\protocol.pyx", line 745, in asyncpg.protocol.protocol.BaseProtocol._check_state
asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\useit\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    resp = await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    raise app_exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 85, in login
    result = await db.execute(
             ^^^^^^^^^^^^^^^^^
        select(User).where(User.email == form_data.username)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('nouser@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-07-31 21:55:46,063 - app.main - INFO - POST /api/v1/auth/login • ip=127.0.0.1 • device_id=- • 422 • 4.4ms
2025-07-31 21:55:46,063 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-07-31 21:55:46,391 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 422 • 1.3ms
2025-07-31 21:55:46,391 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-07-31 22:04:24,688 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 404 • 0.3ms
2025-07-31 22:04:24,689 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 404 Not Found"
2025-07-31 22:04:25,029 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 404 • 0.2ms
2025-07-31 22:04:25,029 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 404 Not Found"
2025-07-31 22:04:25,240 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 404 • 0.2ms
2025-07-31 22:04:25,240 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 404 Not Found"
2025-07-31 22:04:25,455 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 404 • 0.2ms
2025-07-31 22:04:25,455 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 404 Not Found"
2025-07-31 22:04:25,694 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 404 • 0.2ms
2025-07-31 22:04:25,695 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 404 Not Found"
2025-07-31 22:04:25,933 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 404 • 0.2ms
2025-07-31 22:04:25,934 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 404 Not Found"
2025-07-31 22:04:26,135 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 404 • 0.2ms
2025-07-31 22:04:26,135 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 404 Not Found"
2025-07-31 22:04:26,363 - app.main - INFO - POST /api/v1/auth/login • ip=127.0.0.1 • device_id=- • 404 • 0.2ms
2025-07-31 22:04:26,364 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 404 Not Found"
2025-07-31 22:04:26,564 - app.main - INFO - POST /api/v1/auth/login • ip=127.0.0.1 • device_id=- • 404 • 0.3ms
2025-07-31 22:04:26,564 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 404 Not Found"
2025-07-31 22:04:26,770 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 404 • 0.2ms
2025-07-31 22:04:26,770 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 404 Not Found"
2025-07-31 22:05:44,480 - app.main - ERROR - Error on POST /api/v1/auth/signup: Task <Task pending name='starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro' coro=<BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro() running at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py:140> cb=[TaskGroup._spawn.<locals>.task_done() at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\anyio\_backends\_asyncio.py:794]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    resp = await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    raise app_exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 83, in signup
    result = await db.execute(select(User).where(User.email == user_create.email))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise exc_info[1].with_traceback(exc_info[2])
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 794, in _handle_exception
    raise error
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    await self._transaction.start()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    await self._connection.execute(query)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 375, in query
RuntimeError: Task <Task pending name='starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro' coro=<BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro() running at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py:140> cb=[TaskGroup._spawn.<locals>.task_done() at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\anyio\_backends\_asyncio.py:794]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-07-31 22:05:44,492 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: Task <Task pending name='starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro' coro=<BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro() running at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py:140> cb=[TaskGroup._spawn.<locals>.task_done() at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\anyio\_backends\_asyncio.py:794]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 174, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\anyio\_backends\_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 173, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\useit\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 175, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    |     resp = await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    |     raise app_exc
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    |     await self.app(scope, receive, send_wrapper)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 83, in signup
    |     result = await db.execute(select(User).where(User.email == user_create.email))
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    |     result = await greenlet_spawn(
    |              ^^^^^^^^^^^^^^^^^^^^^
    |     ...<6 lines>...
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    |     result = context.throw(*sys.exc_info())
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    |     result: Result[Any] = compile_state_cls.orm_execute_statement(
    |                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self,
    |         ^^^^^
    |     ...<4 lines>...
    |         conn,
    |         ^^^^^
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    |     result = conn.execute(
    |         statement, params or {}, execution_options=execution_options
    |     )
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    |     return meth(
    |         self,
    |         distilled_parameters,
    |         execution_options or NO_OPTIONS,
    |     )
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    |     return connection._execute_clauseelement(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self, distilled_params, execution_options
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    |     ret = self._execute_context(
    |         dialect,
    |     ...<8 lines>...
    |         cache_hit=cache_hit,
    |     )
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    |     return self._exec_single_context(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         dialect, context, statement, parameters
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    |     self._handle_dbapi_exception(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         e, str_statement, effective_parameters, cursor, context
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    |     raise exc_info[1].with_traceback(exc_info[2])
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    |     self.dialect.do_execute(
    |     ~~~~~~~~~~~~~~~~~~~~~~~^
    |         cursor, str_statement, effective_parameters, context
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    |     cursor.execute(statement, parameters)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    |     self._adapt_connection.await_(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self._prepare_and_execute(operation, parameters)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
    |            ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    |     value = await result
    |             ^^^^^^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    |     await adapt_connection._start_transaction()
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    |     self._handle_exception(error)
    |     ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 794, in _handle_exception
    |     raise error
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    |     await self._transaction.start()
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    |     await self._connection.execute(query)
    |   File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    |     result = await self._protocol.query(query, timeout)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "asyncpg\\protocol\\protocol.pyx", line 375, in query
    | RuntimeError: Task <Task pending name='starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro' coro=<BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro() running at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py:140> cb=[TaskGroup._spawn.<locals>.task_done() at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\anyio\_backends\_asyncio.py:794]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\useit\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    resp = await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    raise app_exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 83, in signup
    result = await db.execute(select(User).where(User.email == user_create.email))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise exc_info[1].with_traceback(exc_info[2])
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 794, in _handle_exception
    raise error
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    await self._transaction.start()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    await self._connection.execute(query)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 375, in query
RuntimeError: Task <Task pending name='starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro' coro=<BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro() running at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py:140> cb=[TaskGroup._spawn.<locals>.task_done() at C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\anyio\_backends\_asyncio.py:794]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-07-31 22:05:45,320 - app.main - ERROR - Error on POST /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('user@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    await self._transaction.start()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    await self._connection.execute(query)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 360, in query
  File "asyncpg\\protocol\\protocol.pyx", line 745, in asyncpg.protocol.protocol.BaseProtocol._check_state
asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    resp = await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    raise app_exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 83, in signup
    result = await db.execute(select(User).where(User.email == user_create.email))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('user@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-07-31 22:05:45,325 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('user@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    await self._transaction.start()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    await self._connection.execute(query)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 360, in query
  File "asyncpg\\protocol\\protocol.pyx", line 745, in asyncpg.protocol.protocol.BaseProtocol._check_state
asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\useit\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    resp = await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    raise app_exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 83, in signup
    result = await db.execute(select(User).where(User.email == user_create.email))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('user@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-07-31 22:05:46,134 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 422 • 1.7ms
2025-07-31 22:05:46,134 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-07-31 22:05:46,374 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 422 • 1.2ms
2025-07-31 22:05:46,375 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-07-31 22:05:46,660 - app.main - INFO - POST /api/v1/auth/signup • ip=127.0.0.1 • device_id=- • 422 • 0.9ms
2025-07-31 22:05:46,661 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/signup "HTTP/1.1 422 Unprocessable Entity"
2025-07-31 22:05:46,892 - app.main - ERROR - Error on POST /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('user@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    await self._transaction.start()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    await self._connection.execute(query)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 360, in query
  File "asyncpg\\protocol\\protocol.pyx", line 745, in asyncpg.protocol.protocol.BaseProtocol._check_state
asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    resp = await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    raise app_exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 83, in signup
    result = await db.execute(select(User).where(User.email == user_create.email))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('user@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-07-31 22:05:46,896 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('user@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    await self._transaction.start()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    await self._connection.execute(query)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 360, in query
  File "asyncpg\\protocol\\protocol.pyx", line 745, in asyncpg.protocol.protocol.BaseProtocol._check_state
asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\useit\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    resp = await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    raise app_exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 83, in signup
    result = await db.execute(select(User).where(User.email == user_create.email))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('user@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-07-31 22:05:47,468 - app.main - ERROR - Error on POST /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('user@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    await self._transaction.start()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    await self._connection.execute(query)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 360, in query
  File "asyncpg\\protocol\\protocol.pyx", line 745, in asyncpg.protocol.protocol.BaseProtocol._check_state
asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    resp = await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    raise app_exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 83, in signup
    result = await db.execute(select(User).where(User.email == user_create.email))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('user@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-07-31 22:05:47,472 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('user@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    await self._transaction.start()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    await self._connection.execute(query)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 360, in query
  File "asyncpg\\protocol\\protocol.pyx", line 745, in asyncpg.protocol.protocol.BaseProtocol._check_state
asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\useit\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    resp = await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    raise app_exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 83, in signup
    result = await db.execute(select(User).where(User.email == user_create.email))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('user@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-07-31 22:05:48,103 - app.main - ERROR - Error on POST /api/v1/auth/login: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('nouser@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    await self._transaction.start()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    await self._connection.execute(query)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 360, in query
  File "asyncpg\\protocol\\protocol.pyx", line 745, in asyncpg.protocol.protocol.BaseProtocol._check_state
asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    resp = await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    raise app_exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 42, in login
    result = await db.execute(select(User).where(User.email == form_data.username))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('nouser@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-07-31 22:05:48,107 - app.main - ERROR - Unhandled exception on /api/v1/auth/login: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('nouser@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    await self._transaction.start()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    await self._connection.execute(query)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 360, in query
  File "asyncpg\\protocol\\protocol.pyx", line 745, in asyncpg.protocol.protocol.BaseProtocol._check_state
asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\useit\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    resp = await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    raise app_exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 42, in login
    result = await db.execute(select(User).where(User.email == form_data.username))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('nouser@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-07-31 22:05:48,742 - app.main - INFO - POST /api/v1/auth/login • ip=127.0.0.1 • device_id=- • 422 • 2.4ms
2025-07-31 22:05:48,743 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 422 Unprocessable Entity"
2025-07-31 22:05:48,975 - app.main - ERROR - Error on POST /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('user@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    await self._transaction.start()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    await self._connection.execute(query)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 360, in query
  File "asyncpg\\protocol\\protocol.pyx", line 745, in asyncpg.protocol.protocol.BaseProtocol._check_state
asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    resp = await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    raise app_exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 83, in signup
    result = await db.execute(select(User).where(User.email == user_create.email))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('user@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-07-31 22:05:48,979 - app.main - ERROR - Unhandled exception on /api/v1/auth/signup: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('user@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 843, in _start_transaction
    await self._transaction.start()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\transaction.py", line 146, in start
    await self._connection.execute(query)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\asyncpg\connection.py", line 349, in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 360, in query
  File "asyncpg\\protocol\\protocol.pyx", line 745, in asyncpg.protocol.protocol.BaseProtocol._check_state
asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\useit\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\main.py", line 75, in log_requests
    resp = await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 153, in call_next
    raise app_exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\app\routers\auth.py", line 83, in signup
    result = await db.execute(select(User).where(User.email == user_create.email))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\useit\Hydroleaf-Backend\hydroleaf\env\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
[SQL: SELECT users.id, users.email, users.hashed_password, users.role, users.created_at, users.updated_at, user_profiles_1.id AS id_1, user_profiles_1.user_id, user_profiles_1.first_name, user_profiles_1.last_name, user_profiles_1.phone, user_profiles_1.address, user_profiles_1.city, user_profiles_1.state, user_profiles_1.country, user_profiles_1.postal_code, user_profiles_1.created_at AS created_at_1, user_profiles_1.updated_at AS updated_at_1, farms_1.id AS id_2, farms_1.user_id AS user_id_1, farms_1.name, farms_1.location, farms_1.created_at AS created_at_2, farms_1.updated_at AS updated_at_2 
FROM users LEFT OUTER JOIN user_profiles AS user_profiles_1 ON users.id = user_profiles_1.user_id LEFT OUTER JOIN farms AS farms_1 ON users.id = farms_1.user_id 
WHERE users.email = $1::VARCHAR]
[parameters: ('user@example.com',)]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
